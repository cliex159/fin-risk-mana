<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 15 Homework | FRM2</title>
<meta name="author" content="Tran Thanh Dat">
<meta name="description" content="Problem 1 Give the data Time Data Time Data Time Data 1 10.31778 7 10.36644 13 10.34145 2 10.29235 8 10.36744 14 10.40247 3 10.30075 9 10.39553 15 10.39158 4 10.29208 10 10.48562 16 10.35517 5...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 15 Homework | FRM2">
<meta property="og:type" content="book">
<meta property="og:description" content="Problem 1 Give the data Time Data Time Data Time Data 1 10.31778 7 10.36644 13 10.34145 2 10.29235 8 10.36744 14 10.40247 3 10.30075 9 10.39553 15 10.39158 4 10.29208 10 10.48562 16 10.35517 5...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 15 Homework | FRM2">
<meta name="twitter:description" content="Problem 1 Give the data Time Data Time Data Time Data 1 10.31778 7 10.36644 13 10.34145 2 10.29235 8 10.36744 14 10.40247 3 10.30075 9 10.39553 15 10.39158 4 10.29208 10 10.48562 16 10.35517 5...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">FRM2</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Course Descripition</a></li>
<li class="book-part">Chapter 1 Price and Risk</li>
<li><a class="" href="returns.html"><span class="header-section-number">1</span> Returns</a></li>
<li><a class="" href="random-walk.html"><span class="header-section-number">2</span> Random Walk</a></li>
<li><a class="" href="volatility.html"><span class="header-section-number">3</span> Volatility</a></li>
<li><a class="" href="skewness-kurtosis.html"><span class="header-section-number">4</span> Skewness &amp; Kurtosis</a></li>
<li><a class="" href="fat-tails.html"><span class="header-section-number">5</span> Fat tails</a></li>
<li><a class="" href="mixture-distributions.html"><span class="header-section-number">6</span> Mixture Distributions</a></li>
<li><a class="" href="in-class-exercise.html"><span class="header-section-number">7</span> In-class exercise</a></li>
<li><a class="" href="homework.html"><span class="header-section-number">8</span> Homework</a></li>
<li class="book-part">Chapter 2 Univariate Volatility</li>
<li><a class="" href="stationary-processes.html"><span class="header-section-number">9</span> Stationary processes</a></li>
<li><a class="" href="ewma.html"><span class="header-section-number">10</span> EWMA</a></li>
<li><a class="" href="arch-and-garch.html"><span class="header-section-number">11</span> ARCH and GARCH</a></li>
<li><a class="" href="maximum-likelihood.html"><span class="header-section-number">12</span> Maximum likelihood</a></li>
<li><a class="" href="future-volatility.html"><span class="header-section-number">13</span> Future volatility</a></li>
<li><a class="" href="in-class-exercise-1.html"><span class="header-section-number">14</span> In-class exercise</a></li>
<li><a class="active" href="homework-1.html"><span class="header-section-number">15</span> Homework</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/cliex159/fin-risk-mana">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="homework-1" class="section level1" number="15">
<h1>
<span class="header-section-number">15</span> Homework<a class="anchor" aria-label="anchor" href="#homework-1"><i class="fas fa-link"></i></a>
</h1>
<div id="problem-1-1" class="section level2 unnumbered">
<h2>Problem 1<a class="anchor" aria-label="anchor" href="#problem-1-1"><i class="fas fa-link"></i></a>
</h2>
<p>Give the data</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">Time</th>
<th align="center">Data</th>
<th align="right">Time</th>
<th align="right">Data</th>
<th align="right">Time</th>
<th align="right">Data</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="center">10.31778</td>
<td align="right">7</td>
<td align="right">10.36644</td>
<td align="right">13</td>
<td align="right">10.34145</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="center">10.29235</td>
<td align="right">8</td>
<td align="right">10.36744</td>
<td align="right">14</td>
<td align="right">10.40247</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="center">10.30075</td>
<td align="right">9</td>
<td align="right">10.39553</td>
<td align="right">15</td>
<td align="right">10.39158</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="center">10.29208</td>
<td align="right">10</td>
<td align="right">10.48562</td>
<td align="right">16</td>
<td align="right">10.35517</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="center">10.31304</td>
<td align="right">11</td>
<td align="right">10.47619</td>
<td align="right">17</td>
<td align="right">10.35166</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="center">10.32042</td>
<td align="right">12</td>
<td align="right">10.46396</td>
<td align="right">18</td>
<td align="right">10.36395</td>
</tr>
</tbody>
</table></div>
<p>Calculate the ACF with lags from 0 to 15 and lower, upper bounds with significant Î± = 5%</p>
<div id="python-8" class="section level3 unnumbered">
<h3>Python<a class="anchor" aria-label="anchor" href="#python-8"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb188"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb188-1"><a href="homework-1.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb188-2"><a href="homework-1.html#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb188-3"><a href="homework-1.html#cb188-3" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb188-4"><a href="homework-1.html#cb188-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-5"><a href="homework-1.html#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Import Data</span></span>
<span id="cb188-6"><a href="homework-1.html#cb188-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="fl">10.31778</span>, <span class="fl">10.29235</span>, <span class="fl">10.30075</span>, <span class="fl">10.29208</span>, <span class="fl">10.31304</span>, <span class="fl">10.32042</span>,</span>
<span id="cb188-7"><a href="homework-1.html#cb188-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">10.36644</span>, <span class="fl">10.36744</span>, <span class="fl">10.39553</span>, <span class="fl">10.48562</span>, <span class="fl">10.47619</span>, <span class="fl">10.46396</span>,</span>
<span id="cb188-8"><a href="homework-1.html#cb188-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">10.34145</span>, <span class="fl">10.40247</span>, <span class="fl">10.39158</span>, <span class="fl">10.35517</span>, <span class="fl">10.35166</span>, <span class="fl">10.36395</span>]</span>
<span id="cb188-9"><a href="homework-1.html#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="homework-1.html#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb188-11"><a href="homework-1.html#cb188-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns <span class="op">=</span> [<span class="st">'data'</span>])</span>
<span id="cb188-12"><a href="homework-1.html#cb188-12" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>#&gt;        data
#&gt; 0  10.31778
#&gt; 1  10.29235
#&gt; 2  10.30075
#&gt; 3  10.29208
#&gt; 4  10.31304</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="homework-1.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.stattools <span class="im">import</span> acf</span>
<span id="cb190-2"><a href="homework-1.html#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate ACF</span></span>
<span id="cb190-3"><a href="homework-1.html#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Calculated ACF by lags 0 - 15:</span><span class="ch">\n</span><span class="st">'</span>)</span></code></pre></div>
<pre><code>#&gt; Calculated ACF by lags 0 - 15:</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="homework-1.html#cb192-1" aria-hidden="true" tabindex="-1"></a>acf(df[<span class="st">'data'</span>], nlags <span class="op">=</span> <span class="dv">15</span>)</span></code></pre></div>
<pre><code>#&gt; array([ 1.        ,  0.71637405,  0.48086057,  0.24512236,  0.07189534,
#&gt;        -0.16133272, -0.38073392, -0.39587896, -0.41465118, -0.34811093,
#&gt;        -0.23179094, -0.09359336, -0.02129721, -0.02593246,  0.0128132 ,
#&gt;         0.02943992])</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb194-1"><a href="homework-1.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb194-2"><a href="homework-1.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.graphics.tsaplots <span class="im">import</span> plot_acf</span>
<span id="cb194-3"><a href="homework-1.html#cb194-3" aria-hidden="true" tabindex="-1"></a>plot_acf(df[<span class="st">'data'</span>], lags <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb194-4"><a href="homework-1.html#cb194-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-20-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="r-8" class="section level3 unnumbered">
<h3>R<a class="anchor" aria-label="anchor" href="#r-8"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Import Data</span>
<span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">10.31778</span>, <span class="fl">10.29235</span>, <span class="fl">10.30075</span>, <span class="fl">10.29208</span>, <span class="fl">10.31304</span>, <span class="fl">10.32042</span>,
        <span class="fl">10.36644</span>, <span class="fl">10.36744</span>, <span class="fl">10.39553</span>, <span class="fl">10.48562</span>, <span class="fl">10.47619</span>, <span class="fl">10.46396</span>,
        <span class="fl">10.34145</span>, <span class="fl">10.40247</span>, <span class="fl">10.39158</span>, <span class="fl">10.35517</span>, <span class="fl">10.35166</span>, <span class="fl">10.36395</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; [1] 10.31778 10.29235 10.30075 10.29208 10.31304 10.32042</code></pre>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate ACF</span>
<span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">data</span>,lag.max <span class="op">=</span> <span class="fl">15</span>,plot<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; 
#&gt; Autocorrelations of series 'data', by lag
#&gt; 
#&gt;      0      1      2      3      4      5      6      7      8      9     10 
#&gt;  1.000  0.716  0.481  0.245  0.072 -0.161 -0.381 -0.396 -0.415 -0.348 -0.232 
#&gt;     11     12     13     14     15 
#&gt; -0.094 -0.021 -0.026  0.013  0.029</code></pre>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot ACF</span>
<span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">data</span>,lag.max <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="problem-2-1" class="section level2 unnumbered">
<h2>Problem 2<a class="anchor" aria-label="anchor" href="#problem-2-1"><i class="fas fa-link"></i></a>
</h2>
<p>Consider the <span class="math inline">\(MA(q)\)</span>.</p>
<div id="question-a-7" class="section level3 unnumbered">
<h3>Question a<a class="anchor" aria-label="anchor" href="#question-a-7"><i class="fas fa-link"></i></a>
</h3>
<p>Calculate autocovariance <span class="math inline">\(\gamma(h)\)</span> and ACF <span class="math inline">\(\rho(h)\)</span>.</p>
<blockquote>
<p>Note that MA(q) is stationary since it is a linear combination of stationary
processes. Note that, white noise has
<span class="math display">\[\gamma(0)=Cov(\epsilon_t,\epsilon_{t})=\sigma^2 \]</span>
and $ (h)=0 $ if <span class="math inline">\(h \neq 0\)</span>. For more simple we assume that <span class="math inline">\(E[X_t] = 0\)</span>. So we have the
autocovariance is</p>
</blockquote>
<blockquote>
<p><span class="math display">\[\begin{align*}
\gamma(h) &amp;= Cov(X_t,X_{t+h}) \\
&amp;=Cov(\sum_{i=1}^q \theta_i \epsilon_{t-i},\sum_{j=1}^q \theta_j \epsilon_{t+h-j}) \\
&amp;= \sum_{i=1}^q \sum_{j=1}^q \theta_i \theta_j Cov(\epsilon_{t-i},\epsilon_{t+h-j}) \\
&amp;= \sum_{i=0}^{q-|h|} \theta_i \theta_{i+|h|}\sigma^2, |h| \leq q
\end{align*}\]</span>
Hence,
<span class="math display">\[ \rho(h) = \frac{\sum_{i=0}^{q-|h|} \theta_i \theta_{i+|h|}\sigma^2}{\sum_{i=0}^{q}\theta_i^2} \]</span> and <span class="math inline">\(\rho(h)=0\)</span> for <span class="math inline">\(|h| &gt; q\)</span></p>
</blockquote>
</div>
<div id="question-b-7" class="section level3 unnumbered">
<h3>Question b<a class="anchor" aria-label="anchor" href="#question-b-7"><i class="fas fa-link"></i></a>
</h3>
<p>Show that the MA(1) processes <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span>
<span class="math display">\[\begin{align*}
X_t = \beta \epsilon_{tâ1} + \epsilon_t \\
Y_t = \frac{1}{\beta} \epsilon_{tâ1} + \epsilon_t \\
\end{align*}\]</span>
have the same ACF.</p>
<blockquote>
<p>Consider the <span class="math inline">\(MA(1)\)</span> model <span class="math inline">\(X_t=\beta \epsilon_{t-1}+\epsilon_t\)</span>. The coefficient <span class="math inline">\(\theta_1=\beta\)</span>. The ACF is given by
<span class="math display">\[ \rho_1=\frac{\beta}{1+\beta^2}, (1) \]</span>
and <span class="math inline">\(\rho_h=0, \forall h \geq 2\)</span></p>
</blockquote>
<blockquote>
<p>Consider the <span class="math inline">\(MA(1)\)</span> model <span class="math inline">\(Y_t=\frac{1}{\beta} \epsilon_{t-1}+\epsilon_t\)</span>. The coefficient <span class="math inline">\(\theta_1=\frac{1}{\beta}\)</span>. The ACF is given by
<span class="math display">\[\begin{align*} \rho_1&amp;=\frac{\frac{1}{\beta}}{1+\left(\frac{1}{\beta}\right)^2} \\
&amp;=\frac{1}{\beta} \cdot \frac{\beta^2}{1+\beta^2} \\
&amp;=\frac{\beta}{1+\beta^2}, (2)
\end{align*}\]</span>
and <span class="math inline">\(\rho_h=0, \forall h \geq 2\)</span></p>
</blockquote>
<blockquote>
<p>(1),(2) imply two <span class="math inline">\(MA(1)\)</span> processes above have the same ACF.</p>
</blockquote>
<blockquote>
<p>Answer: <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> have the same ACF.</p>
</blockquote>
</div>
</div>
<div id="problem-3-1" class="section level2 unnumbered">
<h2>Problem 3<a class="anchor" aria-label="anchor" href="#problem-3-1"><i class="fas fa-link"></i></a>
</h2>
<p>Suppose that the stationary process <span class="math inline">\(X_t\)</span> has an autocovariance function given by <span class="math inline">\(\gamma(h)\)</span>.
Consider process <span class="math inline">\(Y_t = X_t â X_{tâ1}\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Is the process <span class="math inline">\(Y_t\)</span> stationary</li>
</ol>
<blockquote>
<p><span class="math display">\[\begin{align*}
\mathbb{E}(Y_t)&amp;=\mathbb{E}(X_t)-\mathbb{E}(X_{t-1}) \\
&amp;=0 \\
Var(Y_t) &amp;=Var(X_t-X_{t=1}) \\
&amp;=Var(X_t)+Var(X_{t-1})-2Cov(X_t,X_{t-1}) \\
&amp;=2\sigma_x^2-2\gamma_x(1) &lt; \infty \\
Cov(Y_t,Y_{t+h})&amp;=Cov(X_t-X_{t-1},X_{t+h}-X_{t+h-1}) \\
&amp;=Cov(X_t,X_{t+h})
-Cov(X_t,X_{t+h-1})
-Cov(X_{t-1},X_{t+h})
+Cov(X_{t-1},X_{t+h-1}) \\
&amp;=\gamma(h)-\gamma(h-1)-\gamma(h+1)+\gamma(h) \\
&amp;=2\gamma(h)-\gamma(h-1)-\gamma(h+1)
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: <span class="math inline">\(\{Yt\}\)</span> is a weakly stationary proces</p>
</blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Find the autocorrelation function of <span class="math inline">\(Y_t\)</span>
</li>
</ol>
<blockquote>
<p><span class="math display">\[\begin{align*}
\rho(h)&amp;=\rho_h(Y_t) \\
&amp;=\frac{\gamma(h)}{\gamma(0)} \\
&amp;=\frac{2\gamma(h)-\gamma(h-1)-\gamma(h+1)}{2 (\gamma(0)-\gamma(1))}
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: The autocorrelation function of <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(\frac{2\gamma(h)-\gamma(h-1)-\gamma(h+1)}{2 (\gamma(0)-\gamma(1))}\)</span></p>
</blockquote>
</div>
<div id="problem-4-1" class="section level2 unnumbered">
<h2>Problem 4<a class="anchor" aria-label="anchor" href="#problem-4-1"><i class="fas fa-link"></i></a>
</h2>
<p>Find the autocorrelation function of the second order moving average process <span class="math inline">\(MA(2)\)</span>
<span class="math display">\[X_t = 0.5 \epsilon_{tâ1} â 0.2 \epsilon_{tâ2} + \epsilon_t\]</span>
where <span class="math inline">\(\epsilon_t\)</span> is the white noise.</p>
<blockquote>
<p>Apply problem <span class="math inline">\(2\)</span> with <span class="math inline">\(q=2\)</span>, we have
<span class="math display">\[ \gamma(h)=\sum_{i=0}^{2-|h|}\theta_i \theta_{i+|h|}\sigma^2, |h| \leq 2 \]</span>
Hence,
<span class="math display">\[\begin{align*}
\gamma(0) &amp;= (\theta_0^2 + \theta_1^2 + \theta_2^2) \sigma^2 \\
&amp;=(0.5^2 + 0.2^2 +1)\sigma^2 \\
&amp;=1.29 \sigma^2 \\
\gamma(1) &amp;= (\theta_0 \theta_1 + \theta_1 \theta_2) \sigma^2 \\
&amp;=(1 \cdot 0.5   - 0.5 \cdot 0.2 )\sigma^2 \\
&amp;=0.4 \sigma^2 \\
\gamma(2) &amp;= \theta_0 \theta_2 \sigma^2 \\
&amp;=-0.2 \sigma^2 \\
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p><span class="math display">\[\begin{align*}
\gamma(0)&amp;=Var(X_t) \\
&amp;=0.5^2 \sigma^2 +0.2^2 \sigma^2+\sigma^2 \\
&amp;=(0.5^2 + 0.2^2 +1)\sigma^2 \\
&amp;=1.29 \sigma^2 \\
\gamma(1) &amp;=Cov(X_t,X_{t-1}) \\
&amp;=Cov(0.5 \epsilon_{t-1} - 0.2 \epsilon_{t-2}+\epsilon_t,0.5 \epsilon_{t-2} -0.2\epsilon_{t-3}+\epsilon_{t-1}) \\
&amp;=0.5 \cdot 1 Var(\epsilon_{t-1})-0.2 \cdot 0.5 Var(\epsilon_{t-2}) \\
&amp;=(0.5 \cdot 1 -0.2 \cdot 0.5)\sigma^2 \\
&amp;=0.4 \sigma^2 \\
\gamma(2) &amp;=Cov(X_t,X_{t-2}) \\
&amp;=Cov(0.5 \epsilon_{t-1} - 0.2 \epsilon_{t-2}+\epsilon_t,0.5 \epsilon_{t-3} -0.2\epsilon_{t-4}+\epsilon_{t-2}) \\
&amp;=-0.2\cdot 1Var(\epsilon_{t-2}) \\
&amp;=-0.2 \sigma^2
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p><span class="math display">\[\rho(h)=\begin{cases}
1&amp;  h=0.\\
0.31&amp;  h=1\\
-0.155&amp;  h=2 \\
0&amp;  h \geq 3
\end{cases}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: The autocorrelation function of the second order moving average process is
<span class="math display">\[\rho(h)=\begin{cases}
1&amp;  h=0.\\
0.31&amp;  h=1\\
-0.155&amp;  h=2 \\
0&amp;  h \geq 3
\end{cases}\]</span></p>
</blockquote>
</div>
<div id="problem-5-1" class="section level2 unnumbered">
<h2>Problem 5<a class="anchor" aria-label="anchor" href="#problem-5-1"><i class="fas fa-link"></i></a>
</h2>
<p>Assume that the price of an asset at close of trading yesterday was $300 and its volatility was estimated as 1.3% per day. The price at the close of trading today is $298. Update the volatility estimate by using the following methods:</p>
<div id="question-a-8" class="section level3 unnumbered">
<h3>Question a<a class="anchor" aria-label="anchor" href="#question-a-8"><i class="fas fa-link"></i></a>
</h3>
<p>EWMA with <span class="math inline">\(\lambda=0.94\)</span>.</p>
<blockquote>
<p><span class="math display">\[\begin{align*}
\widehat{\sigma}_t^2 &amp;=\lambda\cdot\widehat{\sigma}_{t-1}^2+(1-\lambda)\cdot y_{t-1}^2 \\
&amp;=0.94\cdot0.013^2+0.06\cdot\left( \ln \frac{298}{300}\right)^2 \\
&amp;\approx1.6153\cdot10^{-4} \\
\rightarrow \widehat{\sigma}_t &amp;\approx0.0127
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: The volatility estimate by using the EWMA with <span class="math inline">\(\lambda=0.94\)</span> is <span class="math inline">\(1.27\%\)</span>.</p>
</blockquote>
</div>
<div id="question-b-8" class="section level3 unnumbered">
<h3>Question b<a class="anchor" aria-label="anchor" href="#question-b-8"><i class="fas fa-link"></i></a>
</h3>
<p>The GARCH<span class="math inline">\((1,1)\)</span> model with <span class="math inline">\(\omega=2\cdot10^{-6},\alpha=0.04,\beta=0.94\)</span>.</p>
<blockquote>
<p><span class="math display">\[\begin{align*}
\widehat{\sigma}_t^2 &amp;=\omega+\alpha\cdot y_{t-1}^2+\beta\cdot\widehat{\sigma}_{t-1}^2 \\
&amp;=2\cdot10^{-6}+0.04\cdot\left( \ln \frac{300}{298}\right)^2+0.94\cdot0.013^2 \\
&amp;\approx1.6265\cdot10^{-4} \\
\rightarrow \widehat{\sigma}_t &amp;\approx0.0128
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: The volatility estimate by using the GARCH<span class="math inline">\((1,1)\)</span> model with the given parameters is <span class="math inline">\(1.28\%\)</span>.</p>
</blockquote>
</div>
</div>
<div id="problem-6-1" class="section level2 unnumbered">
<h2>Problem 6<a class="anchor" aria-label="anchor" href="#problem-6-1"><i class="fas fa-link"></i></a>
</h2>
<p>Suppose that the parameters in a GARCH<span class="math inline">\((1,1)\)</span> model are <span class="math inline">\(\alpha=0.03,\beta=0.95,\omega=2\cdot10^{-6}.\)</span></p>
<div id="question-a-9" class="section level3 unnumbered">
<h3>Question a<a class="anchor" aria-label="anchor" href="#question-a-9"><i class="fas fa-link"></i></a>
</h3>
<p>What is the long-run average volatility?</p>
<blockquote>
<p>The long-run average volatility is
<span class="math display">\[\begin{align*}
\sigma &amp;=\sqrt{\frac{\omega}{1-\alpha-\beta}} \\
&amp;=\sqrt{\frac{2\cdot10^{-6}}{1-0.03-0.95}} \\
&amp;=0.01
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: The long-run average volatility is <span class="math inline">\(1\%\)</span>.</p>
</blockquote>
</div>
<div id="question-b-9" class="section level3 unnumbered">
<h3>Question b<a class="anchor" aria-label="anchor" href="#question-b-9"><i class="fas fa-link"></i></a>
</h3>
<p>If the current volatility is <span class="math inline">\(1.5\%\)</span> per day, what is the estimate of the volatility in <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span>, and <span class="math inline">\(60\)</span> days?</p>
<blockquote>
<p>The estimate of the volatility in <span class="math inline">\(20\)</span> days is:
<span class="math display">\[\begin{align*}
\mathbb{E}(\sigma_{n+20}^2) &amp;=\sigma^2+(\alpha+\beta)^{20}\cdot(\sigma_n^2-\sigma^2) \\
&amp;=0.01^2+(0.03+0.95)^{20}\cdot(0.015^2-0.01^2) \\
&amp;\approx1.8345\cdot10^{-4} \\
\rightarrow \sigma_{n+20}&amp;\approx0.0135 \\
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The estimate of the volatility in <span class="math inline">\(40\)</span> days is:
<span class="math display">\[\begin{align*}
\mathbb{E}(\sigma_{n+40}^2) &amp;=\sigma^2+(\alpha+\beta)^{40}\cdot(\sigma_n^2-\sigma^2) \\
&amp;=0.01^2+(0.03+0.95)^{40}\cdot(0.015^2-0.01^2) \\
&amp;\approx1.5571\cdot10^{-4} \\
\rightarrow \sigma_{n+40}&amp;\approx0.0125 \\
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The estimate of the volatility in <span class="math inline">\(60\)</span> days is:
<span class="math display">\[\begin{align*}
\mathbb{E}(\sigma_{n+60}^2) &amp;=\sigma^2+(\alpha+\beta)^{60}\cdot(\sigma_n^2-\sigma^2) \\
&amp;=0.01^2+(0.03+0.95)^{60}\cdot(0.015^2-0.01^2) \\
&amp;\approx1.3719\cdot10^{-4} \\
\rightarrow \sigma_{n+60}&amp;\approx0.0117 \\
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: If the current volatility is <span class="math inline">\(1.5\%\)</span> per day, the estimates of the volatility in <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span>, and <span class="math inline">\(60\)</span> days are <span class="math inline">\(1.35\%\)</span>, <span class="math inline">\(1.25\%\)</span> and <span class="math inline">\(1.17\%\)</span>, respectively.</p>
</blockquote>
</div>
<div id="question-c-4" class="section level3 unnumbered">
<h3>Question c<a class="anchor" aria-label="anchor" href="#question-c-4"><i class="fas fa-link"></i></a>
</h3>
<p>What volatility should be used to price <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span>, and <span class="math inline">\(60\)</span>-day options?</p>
<p>With the current volatility being <span class="math inline">\(1.5\%\)</span> per day, we have</p>
<blockquote>
<p><span class="math display">\[\begin{align*}
a &amp;=\ln\frac{1}{\alpha+\beta} \\
&amp;=\ln\frac{1}{0.03+0.95} \\
&amp;\approx0.0202
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The volatility should be used to price <span class="math inline">\(20\)</span>-day options:
<span class="math display">\[\begin{align*}
\sigma^2(20) &amp;=252\cdot\left(\sigma^2+\frac{1-e^{-20a}}{20a}\cdot(\sigma_{n}^2-\sigma^2)\right) \\
&amp;= 252\cdot\left(0.01^2+\frac{1-e^{-20\cdot0.0202}}{20\cdot0.0202}\cdot(0.015^2-0.01^2)\right)\\
&amp;\approx0.0511 \\
\rightarrow\sigma(20) &amp;\approx0.2261
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The volatility should be used to price <span class="math inline">\(40\)</span>-day options:
<span class="math display">\[\begin{align*}
\sigma^2(40) &amp;=252\cdot\left(\sigma^2+\frac{1-e^{-40a}}{40a}\cdot(\sigma_{n}^2-\sigma^2)\right) \\
&amp;= 252\cdot\left(0.01^2+\frac{1-e^{-40\cdot0.0202}}{40\cdot0.0202}\cdot(0.015^2-0.01^2)\right)\\
&amp;\approx0.0468 \\
\rightarrow\sigma(40) &amp;\approx0.2164
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The volatility should be used to price <span class="math inline">\(60\)</span>-day options:
<span class="math display">\[\begin{align*}
\sigma^2(60) &amp;=252\cdot\left(\sigma^2+\frac{1-e^{-60a}}{60a}\cdot(\sigma_{n}^2-\sigma^2)\right) \\
&amp;= 252\cdot\left(0.01^2+\frac{1-e^{-60\cdot0.0202}}{60\cdot0.0202}\cdot(0.015^2-0.01^2)\right)\\
&amp;\approx0.0435 \\
\rightarrow\sigma(60) &amp;\approx0.2085
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: The volatility should be used to price <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span> and <span class="math inline">\(60\)</span>-day options are <span class="math inline">\(22.61\%\)</span>, <span class="math inline">\(21.64\%\)</span> and <span class="math inline">\(20.85\%\)</span>, respectively.</p>
</blockquote>
</div>
<div id="question-d" class="section level3 unnumbered">
<h3>Question d<a class="anchor" aria-label="anchor" href="#question-d"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose that there is an event that increases the volatility from <span class="math inline">\(1.5%\)</span> per day to <span class="math inline">\(2%\)</span> per day. Estimate the effect on the volatility in <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span>, and <span class="math inline">\(60\)</span> days.</p>
<blockquote>
<p>The estimate of the volatility in <span class="math inline">\(20\)</span> days is:
<span class="math display">\[\begin{align*}
\mathbb{E}(\sigma_{n+20}^2) &amp;=\sigma^2+(\alpha+\beta)^{20}\cdot(\sigma_n^2-\sigma^2) \\
&amp;=0.01^2+(0.03+0.95)^{20}\cdot(0.02^2-0.01^2) \\
&amp;\approx3.0028\cdot10^{-4} \\
\rightarrow \sigma_{n+20}&amp;\approx 0.0173 \\
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The estimate of the volatility in <span class="math inline">\(40\)</span> days is:
<span class="math display">\[\begin{align*}
\mathbb{E}(\sigma_{n+40}^2) &amp;=\sigma^2+(\alpha+\beta)^{40}\cdot(\sigma_n^2-\sigma^2) \\
&amp;=0.01^2+(0.03+0.95)^{40}\cdot(0.02^2-0.01^2) \\
&amp;\approx2.3371\cdot10^{-4} \\
\rightarrow \sigma_{n+40}&amp;\approx 0.0153\\
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The estimate of the volatility in <span class="math inline">\(60\)</span> days is:
<span class="math display">\[\begin{align*}
\mathbb{E}(\sigma_{n+60}^2) &amp;=\sigma^2+(\alpha+\beta)^{60}\cdot(\sigma_n^2-\sigma^2) \\
&amp;=0.01^2+(0.03+0.95)^{60}\cdot(0.02^2-0.01^2) \\
&amp;\approx1.8927\cdot10^{-4} \\
\rightarrow \sigma_{n+60}&amp;\approx 0.0138\\
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<ul>
If the current volatility is <span class="math inline">\(1.5\%\)</span> per day, the estimates of the volatility in <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span>, and <span class="math inline">\(60\)</span> days are <span class="math inline">\(0.0135\)</span>, <span class="math inline">\(0.0125\)</span> and <span class="math inline">\(0.0117\)</span>, respectively.
</ul>
<ul>
If the current volatility is <span class="math inline">\(2\%\)</span> per day, the estimates of the volatility in <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span>, and <span class="math inline">\(60\)</span> days are <span class="math inline">\(0.0173\)</span>, <span class="math inline">\(0.0153\)</span> and <span class="math inline">\(0.0138\)</span>, respectively.
</ul>
<p>Therefore, the volatility in <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span> and <span class="math inline">\(60\)</span> days increases respectively by
<span class="math display">\[\frac{0.0173}{0.0135}-1\approx0.2814 \\
\frac{0.0153}{0.0125}-1\approx0.2240 \\
\frac{0.0138}{0.0117}-1\approx0.1795\]</span></p>
</blockquote>
<blockquote>
<p>Answer: If there is an event that increases the volatility from <span class="math inline">\(1.5%\)</span> per day to <span class="math inline">\(2%\)</span> per day, the volatility in <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span> and <span class="math inline">\(60\)</span> days increases by <span class="math inline">\(28.14\%\)</span>, <span class="math inline">\(22.4\%\)</span> and <span class="math inline">\(17.95\%\)</span>, respectively.</p>
</blockquote>
</div>
<div id="question-e" class="section level3 unnumbered">
<h3>Question e<a class="anchor" aria-label="anchor" href="#question-e"><i class="fas fa-link"></i></a>
</h3>
<p>Estimate by how much the event increases the volatilities used to price <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span>, and <span class="math inline">\(60\)</span>-day options.</p>
<p>With the current volatility being <span class="math inline">\(2\%\)</span> per day, we have</p>
<blockquote>
<p><span class="math display">\[\begin{align*}
a &amp;=\ln\frac{1}{\alpha+\beta} \\
&amp;=\ln\frac{1}{0.03+0.95} \\
&amp;\approx0.0202
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The volatility should be used to price <span class="math inline">\(20\)</span>-day options:
<span class="math display">\[\begin{align*}
\sigma^2(20) &amp;=252\cdot\left(\sigma^2+\frac{1-e^{-20a}}{20a}\cdot(\sigma_{n}^2-\sigma^2)\right) \\
&amp;= 252\cdot\left(0.01^2+\frac{1-e^{-20\cdot0.0202}}{20\cdot0.0202}\cdot(0.02^2-0.01^2)\right)\\
&amp;\approx0.0874 \\
\rightarrow\sigma(20) &amp;\approx0.2956
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The volatility should be used to price <span class="math inline">\(40\)</span>-day options:
<span class="math display">\[\begin{align*}
\sigma^2(40) &amp;=252\cdot\left(\sigma^2+\frac{1-e^{-40a}}{40a}\cdot(\sigma_{n}^2-\sigma^2)\right) \\
&amp;= 252\cdot\left(0.01^2+\frac{1-e^{-40\cdot0.0202}}{40\cdot0.0202}\cdot(0.02^2-0.01^2)\right)\\
&amp;\approx0.0771 \\
\rightarrow\sigma(40) &amp;\approx0.2776
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>The volatility should be used to price <span class="math inline">\(60\)</span>-day options:
<span class="math display">\[\begin{align*}
\sigma^2(60) &amp;=252\cdot\left(\sigma^2+\frac{1-e^{-60a}}{60a}\cdot(\sigma_{n}^2-\sigma^2)\right) \\
&amp;= 252\cdot\left(0.01^2+\frac{1-e^{-60\cdot0.0202}}{60\cdot0.0202}\cdot(0.02^2-0.01^2)\right)\\
&amp;\approx0.0690 \\
\rightarrow\sigma(60) &amp;\approx0.2627
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<ul>
If the current volatility is <span class="math inline">\(1.5\%\)</span> per day, the volatility should be used to price <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span> and <span class="math inline">\(60\)</span>-day options are <span class="math inline">\(0.2261\)</span>, <span class="math inline">\(0.2164\)</span> and <span class="math inline">\(0.2085\)</span>, respectively.
</ul>
<ul>
If the current volatility is <span class="math inline">\(2\%\)</span> per day, the volatility should be used to price <span class="math inline">\(20\)</span>, <span class="math inline">\(40\)</span> and <span class="math inline">\(60\)</span>-day options are <span class="math inline">\(0.2956\)</span>, <span class="math inline">\(0.2776\)</span> and <span class="math inline">\(0.2627\)</span>, respectively.
</ul>
<p>Therefore, if there is an event that increases the volatility from <span class="math inline">\(1.5%\)</span> per day to <span class="math inline">\(2%\)</span> per day, the volatilities used to price increase by
<span class="math display">\[\frac{0.2956}{0.2261}-1\approx0.3074 \\
\frac{0.2776}{0.2164}-1\approx0.2828 \\
\frac{0.2627}{0.2085}-1\approx0.2600\]</span></p>
</blockquote>
<blockquote>
<p>Answer: If there is an event that increases the volatility from <span class="math inline">\(1.5%\)</span> per day to <span class="math inline">\(2%\)</span> per day, the volatilities used to price increase by <span class="math inline">\(30.74\%\)</span>, <span class="math inline">\(28.28\%\)</span> and <span class="math inline">\(26\%\)</span>, respectively.</p>
</blockquote>
</div>
</div>
<div id="problem-7-1" class="section level2 unnumbered">
<h2>Problem 7<a class="anchor" aria-label="anchor" href="#problem-7-1"><i class="fas fa-link"></i></a>
</h2>
<p>Consider ARCH<span class="math inline">\((1)\)</span> process, show that
<span class="math display">\[\mathbb{E}(\sigma_{t+s}^2|\mathcal{F}_t)=\frac{1-\alpha^s}{1-\alpha}\cdot\omega+\alpha^s\cdot\sigma_t^2,\forall s\geq1\]</span></p>
<blockquote>
<p>Consider the following ARCH<span class="math inline">\((1)\)</span> process:
<span class="math display">\[\sigma_{t+1}^2=\omega+\alpha \sigma_t^2\epsilon_t^2\]</span>
We will prove the assertion
<span class="math display">\[\mathbb{E}(\sigma_{t+s}^2|\mathcal{F}_t)=\frac{1-\alpha^s}{1-\alpha}\cdot\omega+\alpha^s\sigma_t^2,\forall s\geq1\]</span>
by induction on <span class="math inline">\(s\)</span>.</p>
</blockquote>
<blockquote>
<p>For <span class="math inline">\(s=1\)</span>:
<span class="math display">\[\begin{align*}
\mathbb{E}(\sigma_{t+1}^2|\mathcal{F}_t) &amp;=\mathbb{E}(\omega+\alpha \sigma_t^2\epsilon_t^2|\mathcal{F}_t) \\
&amp;=\mathbb{E}(\omega+\alpha \sigma_t^2\epsilon_t^2) \\
&amp;=\mathbb{E}(\omega)+\mathbb{E}(\alpha \sigma_t^2\epsilon_t^2) \\
&amp;=\omega+\alpha \sigma_t^2\mathbb{E}(\epsilon_t^2) \\
&amp;=\frac{1-\alpha^1}{1-\alpha}\cdot\omega+\alpha \sigma_t^2
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Assume the assertion holds for some <span class="math inline">\(k\in\mathbb{N}\)</span>. That is:
<span class="math display">\[\begin{align*}
\mathbb{E}(\sigma_{t+k+1}^2|\mathcal{F}_t) &amp;= \mathbb{E}(\mathbb{E}(\sigma_{t+k+1}^2|\mathcal{F}_{t+1})|\mathcal{F}_t) \\
&amp;=\mathbb{E}\left(\left.\frac{1-\alpha^k}{1-\alpha}\cdot\omega+\alpha^k\sigma_{t+1}^2\right|\mathcal{F}_t\right)\\
&amp;= \frac{1-\alpha^k}{1-\alpha}\cdot\omega+\alpha^k\mathbb{E}(\sigma_{t+1}^2|\mathcal{F}_t) \\
&amp;=\frac{1-\alpha^k}{1-\alpha}\cdot\omega+\alpha^k(\omega+\alpha \sigma_t^2)\\
&amp;= \left(\frac{1-\alpha^k}{1-\alpha}+\alpha^k\right)\cdot\omega+\alpha^{k+1}\sigma_t^2 \\
&amp;=\frac{1-\alpha^{k+1}}{1-\alpha}\cdot\omega+\alpha^{k+1}\sigma_t^2
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Therefore, the assertion holds <span class="math inline">\(\forall s\geq1\)</span>.</p>
</blockquote>
</div>
<div id="problem-8-1" class="section level2 unnumbered">
<h2>Problem 8<a class="anchor" aria-label="anchor" href="#problem-8-1"><i class="fas fa-link"></i></a>
</h2>
<div id="python-9" class="section level3 unnumbered">
<h3>Python<a class="anchor" aria-label="anchor" href="#python-9"><i class="fas fa-link"></i></a>
</h3>
<p>We can download the SP500 data from internet by using Python.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb201-1"><a href="homework-1.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas_datareader <span class="im">as</span> web</span>
<span id="cb201-2"><a href="homework-1.html#cb201-2" aria-hidden="true" tabindex="-1"></a>price <span class="op">=</span> web.get_data_yahoo(<span class="st">"^GSPC"</span>,</span>
<span id="cb201-3"><a href="homework-1.html#cb201-3" aria-hidden="true" tabindex="-1"></a>                           start <span class="op">=</span> <span class="st">"2009-01-01"</span>,</span>
<span id="cb201-4"><a href="homework-1.html#cb201-4" aria-hidden="true" tabindex="-1"></a>                           end <span class="op">=</span><span class="st">"2021-12-31"</span>)</span></code></pre></div>
</div>
<div id="question-a-10" class="section level3 unnumbered">
<h3>Question a<a class="anchor" aria-label="anchor" href="#question-a-10"><i class="fas fa-link"></i></a>
</h3>
<p>Denote <span class="math inline">\(y\)</span> the returns of SP500. Plot the returns and calculate statistical characterizations of returns (e.g., min, max, sd, skewness, kurtosis, acf), use Jarque Berra test, Box test.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb202-1"><a href="homework-1.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate returns y</span></span>
<span id="cb202-2"><a href="homework-1.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb202-3"><a href="homework-1.html#cb202-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.diff(np.log(price[<span class="st">'Adj Close'</span>]))</span></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb203-1"><a href="homework-1.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the returns</span></span>
<span id="cb203-2"><a href="homework-1.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb203-3"><a href="homework-1.html#cb203-3" aria-hidden="true" tabindex="-1"></a>plt.plot(y)</span>
<span id="cb203-4"><a href="homework-1.html#cb203-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb204"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="homework-1.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical characterizations of returns</span></span>
<span id="cb204-2"><a href="homework-1.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> describe</span>
<span id="cb204-3"><a href="homework-1.html#cb204-3" aria-hidden="true" tabindex="-1"></a>describe(y)</span></code></pre></div>
<pre><code>#&gt; DescribeResult(nobs=3273, minmax=(-0.12765219747281709, 0.08968323251796306), mean=0.0005081885399690335, variance=0.0001314375361112753, skewness=-0.6777972104478536, kurtosis=13.133833345827092)</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="homework-1.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autocorrelation function</span></span>
<span id="cb206-2"><a href="homework-1.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.stattools <span class="im">import</span> acf</span>
<span id="cb206-3"><a href="homework-1.html#cb206-3" aria-hidden="true" tabindex="-1"></a>acf(y)</span></code></pre></div>
<pre><code>#&gt; array([ 1.        , -0.1437426 ,  0.0873594 , -0.03140535, -0.019112  ,
#&gt;         0.00508723, -0.0803378 ,  0.10808321, -0.094185  ,  0.07152584,
#&gt;        -0.00891499, -0.00466423,  0.01929302, -0.04416083,  0.01990267,
#&gt;        -0.07326844,  0.05878776, -0.00504835, -0.02597924, -0.01826176,
#&gt;        -0.01700834,  0.03833622, -0.06437332,  0.03621343, -0.01485914,
#&gt;        -0.03767194, -0.02067457,  0.02913685, -0.01740174,  0.00977897,
#&gt;         0.00331506,  0.00575203, -0.03713924,  0.01212813, -0.01917425,
#&gt;         0.00639421])</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb208-1"><a href="homework-1.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ACF of the returns</span></span>
<span id="cb208-2"><a href="homework-1.html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb208-3"><a href="homework-1.html#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.graphics.tsaplots <span class="im">import</span> plot_acf</span>
<span id="cb208-4"><a href="homework-1.html#cb208-4" aria-hidden="true" tabindex="-1"></a>plot_acf(y)</span>
<span id="cb208-5"><a href="homework-1.html#cb208-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-30-3.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb209"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb209-1"><a href="homework-1.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jarque Berra test</span></span>
<span id="cb209-2"><a href="homework-1.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb209-3"><a href="homework-1.html#cb209-3" aria-hidden="true" tabindex="-1"></a>stats.jarque_bera(y)</span></code></pre></div>
<pre><code>#&gt; Jarque_beraResult(statistic=23774.964889700783, pvalue=0.0)</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb211-1"><a href="homework-1.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box test</span></span>
<span id="cb211-2"><a href="homework-1.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.diagnostic <span class="im">import</span> acorr_ljungbox</span>
<span id="cb211-3"><a href="homework-1.html#cb211-3" aria-hidden="true" tabindex="-1"></a>acorr_ljungbox(y)</span></code></pre></div>
<pre><code>#&gt;        lb_stat     lb_pvalue
#&gt; 1    67.688520  1.914751e-16
#&gt; 2    92.697505  7.430063e-21
#&gt; 3    95.930588  1.164970e-20
#&gt; 4    97.128307  4.018129e-20
#&gt; 5    97.213193  2.042500e-19
#&gt; 6   118.389393  3.550392e-23
#&gt; 7   156.729878  1.563740e-30
#&gt; 8   185.852981  6.065963e-36
#&gt; 9   202.653903  9.199582e-39
#&gt; 10  202.914988  3.979104e-38</code></pre>
</div>
<div id="question-b-10" class="section level3 unnumbered">
<h3>Question b<a class="anchor" aria-label="anchor" href="#question-b-10"><i class="fas fa-link"></i></a>
</h3>
<p>Use ADF test for the prices and returns to see which series is stationary.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb213-1"><a href="homework-1.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot price</span></span>
<span id="cb213-2"><a href="homework-1.html#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb213-3"><a href="homework-1.html#cb213-3" aria-hidden="true" tabindex="-1"></a>plt.plot(price[<span class="st">'Adj Close'</span>])</span>
<span id="cb213-4"><a href="homework-1.html#cb213-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-33-5.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb214"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb214-1"><a href="homework-1.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ADF test for prices</span></span>
<span id="cb214-2"><a href="homework-1.html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.stattools <span class="im">import</span> adfuller</span>
<span id="cb214-3"><a href="homework-1.html#cb214-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> adfuller(price[<span class="st">'Adj Close'</span>])</span>
<span id="cb214-4"><a href="homework-1.html#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p-value: </span><span class="sc">%f</span><span class="st">'</span> <span class="op">%</span> result[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>#&gt; p-value: 0.998453</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb216-1"><a href="homework-1.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the returns</span></span>
<span id="cb216-2"><a href="homework-1.html#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb216-3"><a href="homework-1.html#cb216-3" aria-hidden="true" tabindex="-1"></a>plt.plot(y)</span>
<span id="cb216-4"><a href="homework-1.html#cb216-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-35-7.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb217"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb217-1"><a href="homework-1.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ADF test for returns</span></span>
<span id="cb217-2"><a href="homework-1.html#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.stattools <span class="im">import</span> adfuller</span>
<span id="cb217-3"><a href="homework-1.html#cb217-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> adfuller(y)</span>
<span id="cb217-4"><a href="homework-1.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p-value: </span><span class="sc">%f</span><span class="st">'</span> <span class="op">%</span> result[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>#&gt; p-value: 0.000000</code></pre>
</div>
<div id="question-c-5" class="section level3 unnumbered">
<h3>Question c<a class="anchor" aria-label="anchor" href="#question-c-5"><i class="fas fa-link"></i></a>
</h3>
<p>Using AR<span class="math inline">\((1)\)</span> to fit the price and returns y and find the coefficients of these fitted AR<span class="math inline">\((1)\)</span> model.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="homework-1.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using AR(1) to fit the price</span></span>
<span id="cb219-2"><a href="homework-1.html#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels</span>
<span id="cb219-3"><a href="homework-1.html#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.arima.model <span class="im">import</span> ARIMA</span>
<span id="cb219-4"><a href="homework-1.html#cb219-4" aria-hidden="true" tabindex="-1"></a>ar1_price <span class="op">=</span> ARIMA(price[<span class="st">'Adj Close'</span>], </span>
<span id="cb219-5"><a href="homework-1.html#cb219-5" aria-hidden="true" tabindex="-1"></a>                  order <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)).fit()</span></code></pre></div>
<pre><code>#&gt; /Users/cliex159/Library/r-miniconda/envs/r-reticulate/lib/python3.8/site-packages/statsmodels/tsa/base/tsa_model.py:471: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ignored when e.g. forecasting.
#&gt;   self._init_dates(dates, freq)
#&gt; /Users/cliex159/Library/r-miniconda/envs/r-reticulate/lib/python3.8/site-packages/statsmodels/tsa/base/tsa_model.py:471: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ignored when e.g. forecasting.
#&gt;   self._init_dates(dates, freq)
#&gt; /Users/cliex159/Library/r-miniconda/envs/r-reticulate/lib/python3.8/site-packages/statsmodels/tsa/base/tsa_model.py:471: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ignored when e.g. forecasting.
#&gt;   self._init_dates(dates, freq)</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="homework-1.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ar1_price.summary())</span></code></pre></div>
<pre><code>#&gt;                                SARIMAX Results                                
#&gt; ==============================================================================
#&gt; Dep. Variable:              Adj Close   No. Observations:                 3274
#&gt; Model:                 ARIMA(1, 0, 0)   Log Likelihood              -15203.588
#&gt; Date:                Thu, 24 Mar 2022   AIC                          30413.175
#&gt; Time:                        16:39:12   BIC                          30431.456
#&gt; Sample:                             0   HQIC                         30419.722
#&gt;                                - 3274                                         
#&gt; Covariance Type:                  opg                                         
#&gt; ==============================================================================
#&gt;                  coef    std err          z      P&gt;|z|      [0.025      0.975]
#&gt; ------------------------------------------------------------------------------
#&gt; const       2159.2460   1157.018      1.866      0.062    -108.467    4426.959
#&gt; ar.L1          0.9998      0.000   2301.214      0.000       0.999       1.001
#&gt; sigma2       630.8779      4.496    140.320      0.000     622.066     639.690
#&gt; ===================================================================================
#&gt; Ljung-Box (L1) (Q):                  87.33   Jarque-Bera (JB):             74201.03
#&gt; Prob(Q):                              0.00   Prob(JB):                         0.00
#&gt; Heteroskedasticity (H):               7.34   Skew:                            -1.12
#&gt; Prob(H) (two-sided):                  0.00   Kurtosis:                        26.21
#&gt; ===================================================================================
#&gt; 
#&gt; Warnings:
#&gt; [1] Covariance matrix calculated using the outer product of gradients (complex-step).</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb223-1"><a href="homework-1.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the coefficients of the fitted AR(1) model</span></span>
<span id="cb223-2"><a href="homework-1.html#cb223-2" aria-hidden="true" tabindex="-1"></a>ar1_price.params[<span class="dv">0</span>:<span class="dv">2</span>]</span></code></pre></div>
<pre><code>#&gt; const    2159.246035
#&gt; ar.L1       0.999802
#&gt; dtype: float64</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb225-1"><a href="homework-1.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using AR(1) to fit the returns</span></span>
<span id="cb225-2"><a href="homework-1.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels</span>
<span id="cb225-3"><a href="homework-1.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.arima.model <span class="im">import</span> ARIMA</span>
<span id="cb225-4"><a href="homework-1.html#cb225-4" aria-hidden="true" tabindex="-1"></a>ar1_y <span class="op">=</span> ARIMA(y, </span>
<span id="cb225-5"><a href="homework-1.html#cb225-5" aria-hidden="true" tabindex="-1"></a>              order <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)).fit()</span>
<span id="cb225-6"><a href="homework-1.html#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ar1_y.summary())</span></code></pre></div>
<pre><code>#&gt;                                SARIMAX Results                                
#&gt; ==============================================================================
#&gt; Dep. Variable:                      y   No. Observations:                 3273
#&gt; Model:                 ARIMA(1, 0, 0)   Log Likelihood               10015.913
#&gt; Date:                Thu, 24 Mar 2022   AIC                         -20025.825
#&gt; Time:                        16:39:13   BIC                         -20007.545
#&gt; Sample:                             0   HQIC                        -20019.279
#&gt;                                - 3273                                         
#&gt; Covariance Type:                  opg                                         
#&gt; ==============================================================================
#&gt;                  coef    std err          z      P&gt;|z|      [0.025      0.975]
#&gt; ------------------------------------------------------------------------------
#&gt; const          0.0005      0.000      2.773      0.006       0.000       0.001
#&gt; ar.L1         -0.1437      0.007    -19.320      0.000      -0.158      -0.129
#&gt; sigma2         0.0001   1.32e-06     97.279      0.000       0.000       0.000
#&gt; ===================================================================================
#&gt; Ljung-Box (L1) (Q):                   0.31   Jarque-Bera (JB):             18498.33
#&gt; Prob(Q):                              0.58   Prob(JB):                         0.00
#&gt; Heteroskedasticity (H):               0.97   Skew:                            -0.83
#&gt; Prob(H) (two-sided):                  0.57   Kurtosis:                        14.53
#&gt; ===================================================================================
#&gt; 
#&gt; Warnings:
#&gt; [1] Covariance matrix calculated using the outer product of gradients (complex-step).</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb227-1"><a href="homework-1.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the coefficients of the fitted AR(1) model</span></span>
<span id="cb227-2"><a href="homework-1.html#cb227-2" aria-hidden="true" tabindex="-1"></a>ar1_y.params[<span class="dv">0</span>:<span class="dv">2</span>]</span></code></pre></div>
<pre><code>#&gt; array([ 0.00050302, -0.14374591])</code></pre>
<p>Note that If the residuals have a mean other than zero, then the forecasts are biased. Now using this fact you can check the mean of residuals of AR<span class="math inline">\((1)\)</span> for price and return to see that you can not apply AR<span class="math inline">\((1)\)</span> directly for price.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb229-1"><a href="homework-1.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the mean of residuals</span></span>
<span id="cb229-2"><a href="homework-1.html#cb229-2" aria-hidden="true" tabindex="-1"></a>ar1_price.resid[<span class="dv">1</span>:].mean()</span></code></pre></div>
<pre><code>#&gt; 1.1800462919613017</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb231-1"><a href="homework-1.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the mean of residuals</span></span>
<span id="cb231-2"><a href="homework-1.html#cb231-2" aria-hidden="true" tabindex="-1"></a>ar1_y.resid[<span class="dv">1</span>:].mean()</span></code></pre></div>
<pre><code>#&gt; -3.311666982146061e-06</code></pre>
<p>Check independence of residuals fitted AR<span class="math inline">\((1)\)</span>, are they independence or not?</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb233-1"><a href="homework-1.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ACF of residuals</span></span>
<span id="cb233-2"><a href="homework-1.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb233-3"><a href="homework-1.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.graphics.tsaplots <span class="im">import</span> plot_acf</span>
<span id="cb233-4"><a href="homework-1.html#cb233-4" aria-hidden="true" tabindex="-1"></a>plot_acf(ar1_y.resid)</span>
<span id="cb233-5"><a href="homework-1.html#cb233-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-43-9.png" width="90%" style="display: block; margin: auto;"></div>
<p>ACF are significant in many lags so the residuals of AR<span class="math inline">\((1)\)</span> of the returns is correlated and thus is not independence.</p>
</div>
<div id="question-d-1" class="section level3 unnumbered">
<h3>Question d<a class="anchor" aria-label="anchor" href="#question-d-1"><i class="fas fa-link"></i></a>
</h3>
<p>Fit the returns by ARMA<span class="math inline">\((3,3)\)</span>, compare with AR<span class="math inline">\((1)\)</span> above, can you conclude that
ARMA<span class="math inline">\((3,3)\)</span> is better than AR<span class="math inline">\((1)\)</span>?</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb234-1"><a href="homework-1.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the returns by ARMA(3,3)</span></span>
<span id="cb234-2"><a href="homework-1.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels</span>
<span id="cb234-3"><a href="homework-1.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.arima.model <span class="im">import</span> ARIMA</span>
<span id="cb234-4"><a href="homework-1.html#cb234-4" aria-hidden="true" tabindex="-1"></a>arma33_y <span class="op">=</span> ARIMA(y, </span>
<span id="cb234-5"><a href="homework-1.html#cb234-5" aria-hidden="true" tabindex="-1"></a>                 order <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">3</span>)).fit()</span>
<span id="cb234-6"><a href="homework-1.html#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arma33_y.summary())</span></code></pre></div>
<pre><code>#&gt;                                SARIMAX Results                                
#&gt; ==============================================================================
#&gt; Dep. Variable:                      y   No. Observations:                 3273
#&gt; Model:                 ARIMA(3, 0, 3)   Log Likelihood               10024.145
#&gt; Date:                Thu, 24 Mar 2022   AIC                         -20032.290
#&gt; Time:                        16:39:19   BIC                         -19983.542
#&gt; Sample:                             0   HQIC                        -20014.833
#&gt;                                - 3273                                         
#&gt; Covariance Type:                  opg                                         
#&gt; ==============================================================================
#&gt;                  coef    std err          z      P&gt;|z|      [0.025      0.975]
#&gt; ------------------------------------------------------------------------------
#&gt; const          0.0005      0.000      2.464      0.014       0.000       0.001
#&gt; ar.L1         -0.0633      2.201     -0.029      0.977      -4.377       4.250
#&gt; ar.L2          0.0372      1.404      0.027      0.979      -2.715       2.789
#&gt; ar.L3         -0.0115      0.374     -0.031      0.976      -0.744       0.721
#&gt; ma.L1         -0.0700      2.201     -0.032      0.975      -4.384       4.244
#&gt; ma.L2          0.0399      1.125      0.035      0.972      -2.166       2.246
#&gt; ma.L3         -0.0131      0.349     -0.038      0.970      -0.697       0.670
#&gt; sigma2         0.0001   1.46e-06     87.390      0.000       0.000       0.000
#&gt; ===================================================================================
#&gt; Ljung-Box (L1) (Q):                   0.00   Jarque-Bera (JB):             17882.67
#&gt; Prob(Q):                              0.99   Prob(JB):                         0.00
#&gt; Heteroskedasticity (H):               0.95   Skew:                            -0.75
#&gt; Prob(H) (two-sided):                  0.45   Kurtosis:                        14.35
#&gt; ===================================================================================
#&gt; 
#&gt; Warnings:
#&gt; [1] Covariance matrix calculated using the outer product of gradients (complex-step).</code></pre>
<p>AIC from ARMA<span class="math inline">\((3,3)\)</span> is less than AIC from AR<span class="math inline">\((1)\)</span> so we can conclude that ARMA<span class="math inline">\((3,3)\)</span> is better than AR<span class="math inline">\((1)\)</span>.</p>
</div>
<div id="question-e-1" class="section level3 unnumbered">
<h3>Question e<a class="anchor" aria-label="anchor" href="#question-e-1"><i class="fas fa-link"></i></a>
</h3>
<p>Use ARCH<span class="math inline">\((1)\)</span>, GARCH<span class="math inline">\((1,1)\)</span> and t-GARCH<span class="math inline">\((1,1)\)</span> to fit the
volatility of the returns and then give your conclusions.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb236-1"><a href="homework-1.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ARCH(1)</span></span>
<span id="cb236-2"><a href="homework-1.html#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arch</span>
<span id="cb236-3"><a href="homework-1.html#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch <span class="im">import</span> arch_model</span>
<span id="cb236-4"><a href="homework-1.html#cb236-4" aria-hidden="true" tabindex="-1"></a>arch_fit <span class="op">=</span> arch_model(y, mean <span class="op">=</span> <span class="st">'Zero'</span>, </span>
<span id="cb236-5"><a href="homework-1.html#cb236-5" aria-hidden="true" tabindex="-1"></a>                         vol <span class="op">=</span> <span class="st">'ARCH'</span>, </span>
<span id="cb236-6"><a href="homework-1.html#cb236-6" aria-hidden="true" tabindex="-1"></a>                         q <span class="op">=</span> <span class="dv">1</span>).fit()</span></code></pre></div>
<pre><code>#&gt; Iteration:      1,   Func. Count:      4,   Neg. LLF: -7592.8746576983285
#&gt; Iteration:      2,   Func. Count:     10,   Neg. LLF: -9873.7669996417
#&gt; Iteration:      3,   Func. Count:     15,   Neg. LLF: 4730401.0010247845
#&gt; Iteration:      4,   Func. Count:     21,   Neg. LLF: -10296.047927667008
#&gt; Iteration:      5,   Func. Count:     23,   Neg. LLF: -10296.047927666674
#&gt; Optimization terminated successfully    (Exit mode 0)
#&gt;             Current function value: -10296.047927667008
#&gt;             Iterations: 5
#&gt;             Function evaluations: 23
#&gt;             Gradient evaluations: 5</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb238-1"><a href="homework-1.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arch_fit.summary())</span></code></pre></div>
<pre><code>#&gt;                         Zero Mean - ARCH Model Results                        
#&gt; ==============================================================================
#&gt; Dep. Variable:                      y   R-squared:                       0.000
#&gt; Mean Model:                 Zero Mean   Adj. R-squared:                  0.000
#&gt; Vol Model:                       ARCH   Log-Likelihood:                10296.0
#&gt; Distribution:                  Normal   AIC:                          -20588.1
#&gt; Method:            Maximum Likelihood   BIC:                          -20575.9
#&gt;                                         No. Observations:                 3273
#&gt; Date:                Thu, Mar 24 2022   Df Residuals:                     3273
#&gt; Time:                        16:39:20   Df Model:                            0
#&gt;                               Volatility Model                              
#&gt; ============================================================================
#&gt;                  coef    std err          t      P&gt;|t|      95.0% Conf. Int.
#&gt; ----------------------------------------------------------------------------
#&gt; omega      7.9907e-05  4.727e-06     16.905  4.106e-64 [7.064e-05,8.917e-05]
#&gt; alpha[1]       0.3975  6.722e-02      5.914  3.348e-09     [  0.266,  0.529]
#&gt; ============================================================================
#&gt; 
#&gt; Covariance estimator: robust</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb240-1"><a href="homework-1.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GARCH(1,1)</span></span>
<span id="cb240-2"><a href="homework-1.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arch</span>
<span id="cb240-3"><a href="homework-1.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch <span class="im">import</span> arch_model</span>
<span id="cb240-4"><a href="homework-1.html#cb240-4" aria-hidden="true" tabindex="-1"></a>garch_fit <span class="op">=</span> arch_model(y, </span>
<span id="cb240-5"><a href="homework-1.html#cb240-5" aria-hidden="true" tabindex="-1"></a>                       mean <span class="op">=</span> <span class="st">'Zero'</span>, </span>
<span id="cb240-6"><a href="homework-1.html#cb240-6" aria-hidden="true" tabindex="-1"></a>                       vol <span class="op">=</span> <span class="st">'GARCH'</span>,</span>
<span id="cb240-7"><a href="homework-1.html#cb240-7" aria-hidden="true" tabindex="-1"></a>                       p <span class="op">=</span> <span class="dv">1</span>, </span>
<span id="cb240-8"><a href="homework-1.html#cb240-8" aria-hidden="true" tabindex="-1"></a>                       q <span class="op">=</span> <span class="dv">1</span>).fit()</span></code></pre></div>
<pre><code>#&gt; Iteration:      1,   Func. Count:      5,   Neg. LLF: 3967.6568400522383
#&gt; Iteration:      2,   Func. Count:     14,   Neg. LLF: -10811.544183900245
#&gt; Optimization terminated successfully    (Exit mode 0)
#&gt;             Current function value: -10811.544186499636
#&gt;             Iterations: 6
#&gt;             Function evaluations: 14
#&gt;             Gradient evaluations: 2</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb242-1"><a href="homework-1.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(garch_fit.summary())</span></code></pre></div>
<pre><code>#&gt;                        Zero Mean - GARCH Model Results                        
#&gt; ==============================================================================
#&gt; Dep. Variable:                      y   R-squared:                       0.000
#&gt; Mean Model:                 Zero Mean   Adj. R-squared:                  0.000
#&gt; Vol Model:                      GARCH   Log-Likelihood:                10811.5
#&gt; Distribution:                  Normal   AIC:                          -21617.1
#&gt; Method:            Maximum Likelihood   BIC:                          -21598.8
#&gt;                                         No. Observations:                 3273
#&gt; Date:                Thu, Mar 24 2022   Df Residuals:                     3273
#&gt; Time:                        16:39:21   Df Model:                            0
#&gt;                               Volatility Model                              
#&gt; ============================================================================
#&gt;                  coef    std err          t      P&gt;|t|      95.0% Conf. Int.
#&gt; ----------------------------------------------------------------------------
#&gt; omega      4.0254e-06  2.451e-10  1.642e+04      0.000 [4.025e-06,4.026e-06]
#&gt; alpha[1]       0.2008  4.872e-03     41.225      0.000     [  0.191,  0.210]
#&gt; beta[1]        0.7802  9.059e-03     86.132      0.000     [  0.762,  0.798]
#&gt; ============================================================================
#&gt; 
#&gt; Covariance estimator: robust</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb244-1"><a href="homework-1.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-GARCH(1,1)</span></span>
<span id="cb244-2"><a href="homework-1.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arch</span>
<span id="cb244-3"><a href="homework-1.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch <span class="im">import</span> arch_model</span>
<span id="cb244-4"><a href="homework-1.html#cb244-4" aria-hidden="true" tabindex="-1"></a>tgarch_fit <span class="op">=</span> arch_model(y, </span>
<span id="cb244-5"><a href="homework-1.html#cb244-5" aria-hidden="true" tabindex="-1"></a>                        mean <span class="op">=</span> <span class="st">'Zero'</span>, </span>
<span id="cb244-6"><a href="homework-1.html#cb244-6" aria-hidden="true" tabindex="-1"></a>                        vol <span class="op">=</span> <span class="st">'GARCH'</span>,</span>
<span id="cb244-7"><a href="homework-1.html#cb244-7" aria-hidden="true" tabindex="-1"></a>                        p <span class="op">=</span> <span class="dv">1</span>, </span>
<span id="cb244-8"><a href="homework-1.html#cb244-8" aria-hidden="true" tabindex="-1"></a>                        q <span class="op">=</span> <span class="dv">1</span>, </span>
<span id="cb244-9"><a href="homework-1.html#cb244-9" aria-hidden="true" tabindex="-1"></a>                        dist <span class="op">=</span> <span class="st">'StudentsT'</span>).fit()</span></code></pre></div>
<pre><code>#&gt; Iteration:      1,   Func. Count:      5,   Neg. LLF: -10902.36462172786
#&gt; Optimization terminated successfully    (Exit mode 0)
#&gt;             Current function value: -10902.36462175196
#&gt;             Iterations: 5
#&gt;             Function evaluations: 5
#&gt;             Gradient evaluations: 1</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb246-1"><a href="homework-1.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tgarch_fit.summary())</span></code></pre></div>
<pre><code>#&gt;                           Zero Mean - GARCH Model Results                           
#&gt; ====================================================================================
#&gt; Dep. Variable:                            y   R-squared:                       0.000
#&gt; Mean Model:                       Zero Mean   Adj. R-squared:                  0.000
#&gt; Vol Model:                            GARCH   Log-Likelihood:                10902.4
#&gt; Distribution:      Standardized Student's t   AIC:                          -21796.7
#&gt; Method:                  Maximum Likelihood   BIC:                          -21772.4
#&gt;                                               No. Observations:                 3273
#&gt; Date:                      Thu, Mar 24 2022   Df Residuals:                     3273
#&gt; Time:                              16:39:22   Df Model:                            0
#&gt;                               Volatility Model                              
#&gt; ============================================================================
#&gt;                  coef    std err          t      P&gt;|t|      95.0% Conf. Int.
#&gt; ----------------------------------------------------------------------------
#&gt; omega      2.6331e-06  6.349e-09    414.698      0.000 [2.621e-06,2.646e-06]
#&gt; alpha[1]       0.2000  1.803e-02     11.094  1.346e-28     [  0.165,  0.235]
#&gt; beta[1]        0.7800  1.543e-02     50.537      0.000     [  0.750,  0.810]
#&gt;                               Distribution                              
#&gt; ========================================================================
#&gt;                  coef    std err          t      P&gt;|t|  95.0% Conf. Int.
#&gt; ------------------------------------------------------------------------
#&gt; nu             6.5511      0.173     37.951      0.000 [  6.213,  6.889]
#&gt; ========================================================================
#&gt; 
#&gt; Covariance estimator: robust</code></pre>
<p>AIC from t-GARCH<span class="math inline">\((1,1)\)</span> is the smallest so we can conclude that t-GARCH<span class="math inline">\((1,1)\)</span> is the best model.</p>
</div>
<div id="r-9" class="section level3 unnumbered">
<h3>R<a class="anchor" aria-label="anchor" href="#r-9"><i class="fas fa-link"></i></a>
</h3>
<p>We can download the SP500 data from internet by using R.</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://zoo.R-Forge.R-project.org/">zoo</a></span><span class="op">)</span>
<span class="va">price</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tseries/man/get.hist.quote.html">get.hist.quote</a></span><span class="op">(</span>instrument <span class="op">=</span> <span class="st">"^gspc"</span>,
                       start <span class="op">=</span> <span class="st">"2009-01-01"</span>,
                       end <span class="op">=</span> <span class="op">(</span><span class="st">"2021-12-31"</span><span class="op">)</span>,  
                       quote <span class="op">=</span> <span class="st">"AdjClose"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; time series starts 2009-01-02
#&gt; time series ends   2021-12-30</code></pre>
</div>
<div id="question-a-11" class="section level3 unnumbered">
<h3>Question a<a class="anchor" aria-label="anchor" href="#question-a-11"><i class="fas fa-link"></i></a>
</h3>
<p>Denote <span class="math inline">\(y\)</span> the returns of SP500. Plot the returns and calculate statistical characterizations of returns (e.g., min, max, sd, skewness, kurtosis, acf), use Jarque Berra test, Box test.</p>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate returns y</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">price</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">log</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">diff</span></code></pre></div>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the returns</span>
<span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">plot</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-50-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Statistical characterizations of returns</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span>
<span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">describe</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">min</span>,
         <span class="va">max</span>,
         <span class="va">sd</span>,
         <span class="va">skew</span>,
         <span class="va">kurtosis</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;      min  max   sd  skew kurtosis
#&gt; X1 -0.13 0.09 0.01 -0.68    13.17</code></pre>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot ACF of the returns</span>
<span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">coredata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">acf</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-52-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Jarque Berra test</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org">moments</a></span><span class="op">)</span>
<span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">coredata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">c</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">jarque.test</span></code></pre></div>
<pre><code>#&gt; 
#&gt;  Jarque-Bera Normality Test
#&gt; 
#&gt; data:  .
#&gt; JB = 23922, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: greater</code></pre>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Box test</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span>
<span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html">Box.test</a></span><span class="op">(</span>lag <span class="op">=</span> <span class="fl">10</span>, 
           type <span class="op">=</span> <span class="st">"Ljung-Box"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; 
#&gt;  Box-Ljung test
#&gt; 
#&gt; data:  .
#&gt; X-squared = 180.1, df = 10, p-value &lt; 2.2e-16</code></pre>
</div>
<div id="question-b-11" class="section level3 unnumbered">
<h3>Question b<a class="anchor" aria-label="anchor" href="#question-b-11"><i class="fas fa-link"></i></a>
</h3>
<p>Use ADF test for the prices and returns to see which series is stationary.</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot price</span>
<span class="va">price</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">plot</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-55-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ADF test for prices</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span>
<span class="va">price</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">coredata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="va">adf.test</span></code></pre></div>
<pre><code>#&gt; Augmented Dickey-Fuller Test 
#&gt; alternative: stationary 
#&gt;  
#&gt; Type 1: no drift no trend 
#&gt;       lag  ADF p.value
#&gt;  [1,]   0 2.96    0.99
#&gt;  [2,]   1 3.59    0.99
#&gt;  [3,]   2 3.25    0.99
#&gt;  [4,]   3 3.19    0.99
#&gt;  [5,]   4 3.46    0.99
#&gt;  [6,]   5 3.42    0.99
#&gt;  [7,]   6 3.77    0.99
#&gt;  [8,]   7 3.28    0.99
#&gt;  [9,]   8 3.62    0.99
#&gt; Type 2: with drift no trend 
#&gt;       lag  ADF p.value
#&gt;  [1,]   0 1.25    0.99
#&gt;  [2,]   1 1.73    0.99
#&gt;  [3,]   2 1.48    0.99
#&gt;  [4,]   3 1.41    0.99
#&gt;  [5,]   4 1.62    0.99
#&gt;  [6,]   5 1.57    0.99
#&gt;  [7,]   6 1.80    0.99
#&gt;  [8,]   7 1.46    0.99
#&gt;  [9,]   8 1.67    0.99
#&gt; Type 3: with drift and trend 
#&gt;       lag    ADF p.value
#&gt;  [1,]   0 -1.238   0.900
#&gt;  [2,]   1 -0.564   0.979
#&gt;  [3,]   2 -0.906   0.952
#&gt;  [4,]   3 -0.951   0.947
#&gt;  [5,]   4 -0.667   0.974
#&gt;  [6,]   5 -0.691   0.971
#&gt;  [7,]   6 -0.351   0.989
#&gt;  [8,]   7 -0.794   0.962
#&gt;  [9,]   8 -0.452   0.984
#&gt; ---- 
#&gt; Note: in fact, p.value = 0.01 means p.value &lt;= 0.01</code></pre>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the returns</span>
<span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">plot</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-57-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ADF test for returns</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span>
<span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">coredata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="va">adf.test</span></code></pre></div>
<pre><code>#&gt; Augmented Dickey-Fuller Test 
#&gt; alternative: stationary 
#&gt;  
#&gt; Type 1: no drift no trend 
#&gt;       lag   ADF p.value
#&gt;  [1,]   0 -65.9    0.01
#&gt;  [2,]   1 -40.3    0.01
#&gt;  [3,]   2 -33.1    0.01
#&gt;  [4,]   3 -29.5    0.01
#&gt;  [5,]   4 -26.1    0.01
#&gt;  [6,]   5 -25.6    0.01
#&gt;  [7,]   6 -21.3    0.01
#&gt;  [8,]   7 -21.2    0.01
#&gt;  [9,]   8 -19.2    0.01
#&gt; Type 2: with drift no trend 
#&gt;       lag   ADF p.value
#&gt;  [1,]   0 -66.1    0.01
#&gt;  [2,]   1 -40.4    0.01
#&gt;  [3,]   2 -33.3    0.01
#&gt;  [4,]   3 -29.6    0.01
#&gt;  [5,]   4 -26.3    0.01
#&gt;  [6,]   5 -25.8    0.01
#&gt;  [7,]   6 -21.5    0.01
#&gt;  [8,]   7 -21.5    0.01
#&gt;  [9,]   8 -19.4    0.01
#&gt; Type 3: with drift and trend 
#&gt;       lag   ADF p.value
#&gt;  [1,]   0 -66.1    0.01
#&gt;  [2,]   1 -40.4    0.01
#&gt;  [3,]   2 -33.3    0.01
#&gt;  [4,]   3 -29.6    0.01
#&gt;  [5,]   4 -26.3    0.01
#&gt;  [6,]   5 -25.8    0.01
#&gt;  [7,]   6 -21.5    0.01
#&gt;  [8,]   7 -21.5    0.01
#&gt;  [9,]   8 -19.4    0.01
#&gt; ---- 
#&gt; Note: in fact, p.value = 0.01 means p.value &lt;= 0.01</code></pre>
</div>
<div id="question-c-6" class="section level3 unnumbered">
<h3>Question c<a class="anchor" aria-label="anchor" href="#question-c-6"><i class="fas fa-link"></i></a>
</h3>
<p>Using AR<span class="math inline">\((1)\)</span> to fit the price and returns y and find the coefficients of these fitted AR<span class="math inline">\((1)\)</span> model.</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using AR(1) to fit the price</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span>
<span class="va">ar1_price</span> <span class="op">=</span> <span class="va">price</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Find the coefficients of the fitted AR(1) model</span>
<span class="va">ar1_price</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="va">coefficients</span></code></pre></div>
<pre><code>#&gt;          ar1    intercept 
#&gt;    0.9999917 2159.3788250</code></pre>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using AR(1) to fit the returns</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span>
<span class="va">ar1_y</span> <span class="op">=</span> <span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Find the coefficients of the fitted AR(1) model</span>
<span class="va">ar1_y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">coefficients</span></code></pre></div>
<pre><code>#&gt;           ar1     intercept 
#&gt; -0.1576312868  0.0005086707</code></pre>
<p>Note that If the residuals have a mean other than zero, then the forecasts are biased. Now using this fact you can check the mean of residuals of AR<span class="math inline">\((1)\)</span> for price and return to see that you can not apply AR<span class="math inline">\((1)\)</span> directly for price.</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Check the mean of residuals</span>
<span class="va">ar1_price</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">residuals</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">coredata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">na.omit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">mean</span></code></pre></div>
<pre><code>#&gt; [1] 1.131751</code></pre>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Check the mean of residuals</span>
<span class="va">ar1_y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">residuals</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">coredata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">na.omit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">mean</span></code></pre></div>
<pre><code>#&gt; [1] -3.824746e-06</code></pre>
<p>Check independence of residuals fitted AR<span class="math inline">\((1)\)</span>, are they independence or not?</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot ACF of the residuals</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span>
<span class="va">ar1_y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">residuals</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">coredata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">na.omit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="va">acf</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-65-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>ACF are significant in many lags so the residuals of AR<span class="math inline">\((1)\)</span> of the returns is correlated and thus is not independence.</p>
</div>
<div id="question-d-2" class="section level3 unnumbered">
<h3>Question d<a class="anchor" aria-label="anchor" href="#question-d-2"><i class="fas fa-link"></i></a>
</h3>
<p>Fit the returns by ARMA<span class="math inline">\((3,3)\)</span>, compare with AR<span class="math inline">\((1)\)</span> above, can you conclude that
ARMA<span class="math inline">\((3,3)\)</span> is better than AR<span class="math inline">\((1)\)</span>?</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Fit the returns by ARMA(3,3)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span>
<span class="va">arma33_y</span> <span class="op">=</span> <span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">arma33_y</span><span class="op">$</span><span class="va">aic</span> <span class="op">&lt;</span> <span class="va">ar1_y</span><span class="op">$</span><span class="va">aic</span></code></pre></div>
<pre><code>#&gt; [1] TRUE</code></pre>
<p>AIC from ARMA<span class="math inline">\((3,3)\)</span> is less than AIC from AR<span class="math inline">\((1)\)</span> so we can conclude that ARMA<span class="math inline">\((3,3)\)</span> is better than AR<span class="math inline">\((1)\)</span>.</p>
</div>
<div id="question-e-2" class="section level3 unnumbered">
<h3>Question e<a class="anchor" aria-label="anchor" href="#question-e-2"><i class="fas fa-link"></i></a>
</h3>
<p>Use ARCH<span class="math inline">\((1)\)</span>, GARCH<span class="math inline">\((1,1)\)</span> and t-GARCH<span class="math inline">\((1,1)\)</span> (using package rugarch) to fit the
volatility of the returns and then give your conclusions.</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ARCH(1)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rmetrics.org">fGarch</a></span><span class="op">)</span>
<span class="va">arch.fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/fGarch/man/garchFit.html">garchFit</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/garch.html">garch</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">y</span>, trace <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">arch.fit</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; 
#&gt; Title:
#&gt;  GARCH Modelling 
#&gt; 
#&gt; Call:
#&gt;  garchFit(formula = ~garch(1, 0), data = y, trace = F) 
#&gt; 
#&gt; Mean and Variance Equation:
#&gt;  data ~ garch(1, 0)
#&gt; &lt;environment: 0x7fc59153aae8&gt;
#&gt;  [data = y]
#&gt; 
#&gt; Conditional Distribution:
#&gt;  norm 
#&gt; 
#&gt; Coefficient(s):
#&gt;         mu       omega      alpha1  
#&gt; 8.6504e-04  7.8455e-05  4.1419e-01  
#&gt; 
#&gt; Std. Errors:
#&gt;  based on Hessian 
#&gt; 
#&gt; Error Analysis:
#&gt;         Estimate  Std. Error  t value Pr(&gt;|t|)    
#&gt; mu     8.650e-04   1.640e-04    5.276 1.32e-07 ***
#&gt; omega  7.845e-05   2.664e-06   29.452  &lt; 2e-16 ***
#&gt; alpha1 4.142e-01   3.821e-02   10.839  &lt; 2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Log Likelihood:
#&gt;  10305.09    normalized:  3.15044 
#&gt; 
#&gt; Description:
#&gt;  Thu Mar 24 16:39:26 2022 by user:  
#&gt; 
#&gt; 
#&gt; Standardised Residuals Tests:
#&gt;                                 Statistic p-Value    
#&gt;  Jarque-Bera Test   R    Chi^2  4427.257  0          
#&gt;  Shapiro-Wilk Test  R    W      0.9298395 0          
#&gt;  Ljung-Box Test     R    Q(10)  22.19605  0.01413642 
#&gt;  Ljung-Box Test     R    Q(15)  31.72511  0.007016061
#&gt;  Ljung-Box Test     R    Q(20)  39.5145   0.005750492
#&gt;  Ljung-Box Test     R^2  Q(10)  663.3026  0          
#&gt;  Ljung-Box Test     R^2  Q(15)  880.8894  0          
#&gt;  Ljung-Box Test     R^2  Q(20)  1068.422  0          
#&gt;  LM Arch Test       R    TR^2   427.7749  0          
#&gt; 
#&gt; Information Criterion Statistics:
#&gt;       AIC       BIC       SIC      HQIC 
#&gt; -6.299046 -6.293458 -6.299048 -6.297045</code></pre>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># GARCH(1,1)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.unstarched.net">rugarch</a></span><span class="op">)</span>
<span class="va">garch_spec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rugarch/man/ugarchspec-methods.html">ugarchspec</a></span><span class="op">(</span>variance.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"sGARCH"</span>,
                                           garchOrder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
                       mean.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>armaOrder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,
                                       include.mean <span class="op">=</span> <span class="cn">T</span>,
                                       distribution.model <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span><span class="op">)</span>
<span class="va">garch_fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rugarch/man/ugarchfit-methods.html">ugarchfit</a></span><span class="op">(</span><span class="va">garch_spec</span>, <span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">coredata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">c</span><span class="op">)</span>
<span class="va">garch_fit</span></code></pre></div>
<pre><code>#&gt; 
#&gt; *---------------------------------*
#&gt; *          GARCH Model Fit        *
#&gt; *---------------------------------*
#&gt; 
#&gt; Conditional Variance Dynamics    
#&gt; -----------------------------------
#&gt; GARCH Model  : sGARCH(1,1)
#&gt; Mean Model   : ARFIMA(0,0,0)
#&gt; Distribution : norm 
#&gt; 
#&gt; Optimal Parameters
#&gt; ------------------------------------
#&gt;         Estimate  Std. Error  t value Pr(&gt;|t|)
#&gt; mu      0.000805    0.000129   6.2607 0.000000
#&gt; omega   0.000003    0.000001   2.6538 0.007958
#&gt; alpha1  0.170394    0.014539  11.7194 0.000000
#&gt; beta1   0.802782    0.015565  51.5761 0.000000
#&gt; 
#&gt; Robust Standard Errors:
#&gt;         Estimate  Std. Error  t value Pr(&gt;|t|)
#&gt; mu      0.000805    0.000185   4.3598 0.000013
#&gt; omega   0.000003    0.000008   0.4560 0.648389
#&gt; alpha1  0.170394    0.025679   6.6356 0.000000
#&gt; beta1   0.802782    0.058438  13.7374 0.000000
#&gt; 
#&gt; LogLikelihood : 10826.74 
#&gt; 
#&gt; Information Criteria
#&gt; ------------------------------------
#&gt;                     
#&gt; Akaike       -6.6174
#&gt; Bayes        -6.6099
#&gt; Shibata      -6.6174
#&gt; Hannan-Quinn -6.6147
#&gt; 
#&gt; Weighted Ljung-Box Test on Standardized Residuals
#&gt; ------------------------------------
#&gt;                         statistic p-value
#&gt; Lag[1]                      4.129 0.04216
#&gt; Lag[2*(p+q)+(p+q)-1][2]     4.271 0.06377
#&gt; Lag[4*(p+q)+(p+q)-1][5]     5.361 0.12664
#&gt; d.o.f=0
#&gt; H0 : No serial correlation
#&gt; 
#&gt; Weighted Ljung-Box Test on Standardized Squared Residuals
#&gt; ------------------------------------
#&gt;                         statistic p-value
#&gt; Lag[1]                     0.3257  0.5682
#&gt; Lag[2*(p+q)+(p+q)-1][5]    2.0941  0.5964
#&gt; Lag[4*(p+q)+(p+q)-1][9]    2.8388  0.7853
#&gt; d.o.f=2
#&gt; 
#&gt; Weighted ARCH LM Tests
#&gt; ------------------------------------
#&gt;             Statistic Shape Scale P-Value
#&gt; ARCH Lag[3]  0.009343 0.500 2.000  0.9230
#&gt; ARCH Lag[5]  0.933101 1.440 1.667  0.7529
#&gt; ARCH Lag[7]  1.242758 2.315 1.543  0.8712
#&gt; 
#&gt; Nyblom stability test
#&gt; ------------------------------------
#&gt; Joint Statistic:  3.0795
#&gt; Individual Statistics:              
#&gt; mu     0.06252
#&gt; omega  0.06964
#&gt; alpha1 0.34031
#&gt; beta1  0.80804
#&gt; 
#&gt; Asymptotic Critical Values (10% 5% 1%)
#&gt; Joint Statistic:          1.07 1.24 1.6
#&gt; Individual Statistic:     0.35 0.47 0.75
#&gt; 
#&gt; Sign Bias Test
#&gt; ------------------------------------
#&gt;                    t-value      prob sig
#&gt; Sign Bias           3.0094 2.637e-03 ***
#&gt; Negative Sign Bias  0.6287 5.296e-01    
#&gt; Positive Sign Bias  1.6317 1.028e-01    
#&gt; Joint Effect       24.5022 1.962e-05 ***
#&gt; 
#&gt; 
#&gt; Adjusted Pearson Goodness-of-Fit Test:
#&gt; ------------------------------------
#&gt;   group statistic p-value(g-1)
#&gt; 1    20     151.8    9.633e-23
#&gt; 2    30     174.9    8.735e-23
#&gt; 3    40     195.7    9.306e-23
#&gt; 4    50     222.6    5.796e-24
#&gt; 
#&gt; 
#&gt; Elapsed time : 0.21032</code></pre>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TGARCH(1,1)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.unstarched.net">rugarch</a></span><span class="op">)</span>
<span class="va">tgarch_spec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rugarch/man/ugarchspec-methods.html">ugarchspec</a></span><span class="op">(</span>variance.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"sGARCH"</span>,
                                           garchOrder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
                       mean.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>armaOrder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,
                                       include.mean <span class="op">=</span> <span class="cn">T</span>,
                                       distribution.model <span class="op">=</span> <span class="st">"std"</span><span class="op">)</span><span class="op">)</span>
<span class="va">tgarch_fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rugarch/man/ugarchfit-methods.html">ugarchfit</a></span><span class="op">(</span><span class="va">tgarch_spec</span>, <span class="va">y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">coredata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">c</span><span class="op">)</span>
<span class="va">tgarch_fit</span></code></pre></div>
<pre><code>#&gt; 
#&gt; *---------------------------------*
#&gt; *          GARCH Model Fit        *
#&gt; *---------------------------------*
#&gt; 
#&gt; Conditional Variance Dynamics    
#&gt; -----------------------------------
#&gt; GARCH Model  : sGARCH(1,1)
#&gt; Mean Model   : ARFIMA(0,0,0)
#&gt; Distribution : norm 
#&gt; 
#&gt; Optimal Parameters
#&gt; ------------------------------------
#&gt;         Estimate  Std. Error  t value Pr(&gt;|t|)
#&gt; mu      0.000805    0.000129   6.2607 0.000000
#&gt; omega   0.000003    0.000001   2.6538 0.007958
#&gt; alpha1  0.170394    0.014539  11.7194 0.000000
#&gt; beta1   0.802782    0.015565  51.5761 0.000000
#&gt; 
#&gt; Robust Standard Errors:
#&gt;         Estimate  Std. Error  t value Pr(&gt;|t|)
#&gt; mu      0.000805    0.000185   4.3598 0.000013
#&gt; omega   0.000003    0.000008   0.4560 0.648389
#&gt; alpha1  0.170394    0.025679   6.6356 0.000000
#&gt; beta1   0.802782    0.058438  13.7374 0.000000
#&gt; 
#&gt; LogLikelihood : 10826.74 
#&gt; 
#&gt; Information Criteria
#&gt; ------------------------------------
#&gt;                     
#&gt; Akaike       -6.6174
#&gt; Bayes        -6.6099
#&gt; Shibata      -6.6174
#&gt; Hannan-Quinn -6.6147
#&gt; 
#&gt; Weighted Ljung-Box Test on Standardized Residuals
#&gt; ------------------------------------
#&gt;                         statistic p-value
#&gt; Lag[1]                      4.129 0.04216
#&gt; Lag[2*(p+q)+(p+q)-1][2]     4.271 0.06377
#&gt; Lag[4*(p+q)+(p+q)-1][5]     5.361 0.12664
#&gt; d.o.f=0
#&gt; H0 : No serial correlation
#&gt; 
#&gt; Weighted Ljung-Box Test on Standardized Squared Residuals
#&gt; ------------------------------------
#&gt;                         statistic p-value
#&gt; Lag[1]                     0.3257  0.5682
#&gt; Lag[2*(p+q)+(p+q)-1][5]    2.0941  0.5964
#&gt; Lag[4*(p+q)+(p+q)-1][9]    2.8388  0.7853
#&gt; d.o.f=2
#&gt; 
#&gt; Weighted ARCH LM Tests
#&gt; ------------------------------------
#&gt;             Statistic Shape Scale P-Value
#&gt; ARCH Lag[3]  0.009343 0.500 2.000  0.9230
#&gt; ARCH Lag[5]  0.933101 1.440 1.667  0.7529
#&gt; ARCH Lag[7]  1.242758 2.315 1.543  0.8712
#&gt; 
#&gt; Nyblom stability test
#&gt; ------------------------------------
#&gt; Joint Statistic:  3.0795
#&gt; Individual Statistics:              
#&gt; mu     0.06252
#&gt; omega  0.06964
#&gt; alpha1 0.34031
#&gt; beta1  0.80804
#&gt; 
#&gt; Asymptotic Critical Values (10% 5% 1%)
#&gt; Joint Statistic:          1.07 1.24 1.6
#&gt; Individual Statistic:     0.35 0.47 0.75
#&gt; 
#&gt; Sign Bias Test
#&gt; ------------------------------------
#&gt;                    t-value      prob sig
#&gt; Sign Bias           3.0094 2.637e-03 ***
#&gt; Negative Sign Bias  0.6287 5.296e-01    
#&gt; Positive Sign Bias  1.6317 1.028e-01    
#&gt; Joint Effect       24.5022 1.962e-05 ***
#&gt; 
#&gt; 
#&gt; Adjusted Pearson Goodness-of-Fit Test:
#&gt; ------------------------------------
#&gt;   group statistic p-value(g-1)
#&gt; 1    20     151.8    9.633e-23
#&gt; 2    30     174.9    8.735e-23
#&gt; 3    40     195.7    9.306e-23
#&gt; 4    50     222.6    5.796e-24
#&gt; 
#&gt; 
#&gt; Elapsed time : 0.360929</code></pre>
<p>AIC from t-GARCH<span class="math inline">\((1,1)\)</span> is the smallest so we can conclude that t-GARCH<span class="math inline">\((1,1)\)</span> is the best model.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="in-class-exercise-1.html"><span class="header-section-number">14</span> In-class exercise</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#homework-1"><span class="header-section-number">15</span> Homework</a></li>
<li>
<a class="nav-link" href="#problem-1-1">Problem 1</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#python-8">Python</a></li>
<li><a class="nav-link" href="#r-8">R</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#problem-2-1">Problem 2</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#question-a-7">Question a</a></li>
<li><a class="nav-link" href="#question-b-7">Question b</a></li>
</ul>
</li>
<li><a class="nav-link" href="#problem-3-1">Problem 3</a></li>
<li><a class="nav-link" href="#problem-4-1">Problem 4</a></li>
<li>
<a class="nav-link" href="#problem-5-1">Problem 5</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#question-a-8">Question a</a></li>
<li><a class="nav-link" href="#question-b-8">Question b</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#problem-6-1">Problem 6</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#question-a-9">Question a</a></li>
<li><a class="nav-link" href="#question-b-9">Question b</a></li>
<li><a class="nav-link" href="#question-c-4">Question c</a></li>
<li><a class="nav-link" href="#question-d">Question d</a></li>
<li><a class="nav-link" href="#question-e">Question e</a></li>
</ul>
</li>
<li><a class="nav-link" href="#problem-7-1">Problem 7</a></li>
<li>
<a class="nav-link" href="#problem-8-1">Problem 8</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#python-9">Python</a></li>
<li><a class="nav-link" href="#question-a-10">Question a</a></li>
<li><a class="nav-link" href="#question-b-10">Question b</a></li>
<li><a class="nav-link" href="#question-c-5">Question c</a></li>
<li><a class="nav-link" href="#question-d-1">Question d</a></li>
<li><a class="nav-link" href="#question-e-1">Question e</a></li>
<li><a class="nav-link" href="#r-9">R</a></li>
<li><a class="nav-link" href="#question-a-11">Question a</a></li>
<li><a class="nav-link" href="#question-b-11">Question b</a></li>
<li><a class="nav-link" href="#question-c-6">Question c</a></li>
<li><a class="nav-link" href="#question-d-2">Question d</a></li>
<li><a class="nav-link" href="#question-e-2">Question e</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/cliex159/fin-risk-mana/blob/master/02-cross-refs.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/cliex159/fin-risk-mana/edit/master/02-cross-refs.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>FRM2</strong>" was written by Tran Thanh Dat. It was last built on 2022-04-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
