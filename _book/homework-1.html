<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 15 Homework | FRM2</title>
<meta name="author" content="Tran Thanh Dat">
<meta name="description" content="15.1 Problem 5 Let \((X_n)_{n \geq 0}\) be a log-normal geometric random walk with parameters \(\mu\) and \(\sigma\), i.e. \[ X_k= X_0 e^{\sum_{i=1}^k r_i}, \forall k \in \mathbb{N} \] where \(r_i...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 15 Homework | FRM2">
<meta property="og:type" content="book">
<meta property="og:description" content="15.1 Problem 5 Let \((X_n)_{n \geq 0}\) be a log-normal geometric random walk with parameters \(\mu\) and \(\sigma\), i.e. \[ X_k= X_0 e^{\sum_{i=1}^k r_i}, \forall k \in \mathbb{N} \] where \(r_i...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 15 Homework | FRM2">
<meta name="twitter:description" content="15.1 Problem 5 Let \((X_n)_{n \geq 0}\) be a log-normal geometric random walk with parameters \(\mu\) and \(\sigma\), i.e. \[ X_k= X_0 e^{\sum_{i=1}^k r_i}, \forall k \in \mathbb{N} \] where \(r_i...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.12.1/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">FRM2</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Course Descripition</a></li>
<li class="book-part">Chapter 1 Price and Risk</li>
<li><a class="" href="returns.html"><span class="header-section-number">1</span> Returns</a></li>
<li><a class="" href="random-walk.html"><span class="header-section-number">2</span> Random Walk</a></li>
<li><a class="" href="volatility.html"><span class="header-section-number">3</span> Volatility</a></li>
<li><a class="" href="skewness-kurtosis.html"><span class="header-section-number">4</span> Skewness &amp; Kurtosis</a></li>
<li><a class="" href="fat-tails.html"><span class="header-section-number">5</span> Fat tails</a></li>
<li><a class="" href="mixture-distributions.html"><span class="header-section-number">6</span> Mixture Distributions</a></li>
<li><a class="" href="in-class-exercise.html"><span class="header-section-number">7</span> In-class exercise</a></li>
<li><a class="" href="homework.html"><span class="header-section-number">8</span> Homework</a></li>
<li class="book-part">Chapter 2 Univariate Volatility</li>
<li><a class="" href="stationary-processes.html"><span class="header-section-number">9</span> Stationary processes</a></li>
<li><a class="" href="ewma.html"><span class="header-section-number">10</span> EWMA</a></li>
<li><a class="" href="arch-and-garch.html"><span class="header-section-number">11</span> ARCH and GARCH</a></li>
<li><a class="" href="maximum-likelihood.html"><span class="header-section-number">12</span> Maximum likelihood</a></li>
<li><a class="" href="future-volatility.html"><span class="header-section-number">13</span> Future volatility</a></li>
<li><a class="" href="in-class-exercise-1.html"><span class="header-section-number">14</span> In-class exercise</a></li>
<li><a class="active" href="homework-1.html"><span class="header-section-number">15</span> Homework</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/cliex159/fin-risk-mana">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="homework-1" class="section level1" number="15">
<h1>
<span class="header-section-number">15</span> Homework<a class="anchor" aria-label="anchor" href="#homework-1"><i class="fas fa-link"></i></a>
</h1>
<div id="problem-5" class="section level2" number="15.1">
<h2>
<span class="header-section-number">15.1</span> Problem 5<a class="anchor" aria-label="anchor" href="#problem-5"><i class="fas fa-link"></i></a>
</h2>
<p>Let <span class="math inline">\((X_n)_{n \geq 0}\)</span> be a log-normal geometric random walk with parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, i.e.</p>
<p><span class="math display">\[ X_k= X_0 e^{\sum_{i=1}^k r_i}, \forall k \in \mathbb{N} \]</span></p>
<p>where <span class="math inline">\(r_i \sim \mathcal{N}(\mu,\sigma^2)\)</span> are i.i.d and <span class="math inline">\(X_0 \neq 0\)</span> is constant.</p>
<ol style="list-style-type: lower-alpha">
<li>Determine <span class="math inline">\(P(X_2 &gt; 1.3X_0)\)</span>.</li>
</ol>
<blockquote>
<p><span class="math display">\[\begin{align*}
r_1+r_2 &amp;\sim \mathcal{N}(\mu,\sigma^2)+\mathcal{N}(\mu,\sigma^2) \\
&amp;\sim \mathcal{N}(2\mu,2\sigma^2)
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p><span class="math display">\[\begin{align*}
\mathbb{P}(X_2&gt;1.3X_0) &amp;= \mathbb{P} \left( \frac{X_2}{X_0}&gt;1.3 \right) \\
&amp;= \mathbb{P} \left( e^{r_1+r_2}&gt;1.3 \right) \\
&amp;=\mathbb{P} \left({r_1+r_2}&gt;\ln(1.3) \right) \\
&amp;=\mathbb{P} \left( \mathcal{Z} &gt; \frac{\ln(1.3)-2\mu}{\sigma \sqrt{2}} \right) \\
&amp;=1-\Phi \left( \frac{\ln(1.3)-2\mu}{\sigma \sqrt{2}} \right)
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: <span class="math inline">\(\mathbb{P}(X_2&gt;1.3X_0)=1-\Phi \left( \frac{\ln(1.3)-2\mu}{\sigma \sqrt{2}} \right)\)</span></p>
</blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Find the density <span class="math inline">\(f_{X_1}\)</span> of <span class="math inline">\(X_1\)</span>.</li>
</ol>
<blockquote>
<p><span class="math display">\[\begin{align*}
F_{X_1}(x) &amp;=\mathbb{P}(X_1 \leq x) \\
&amp;=\mathbb(X_0e^{r_1} \leq x) \\
&amp;=\mathbb{P}(r_1 \leq \ln(x)-\ln(X_0) \\
&amp;=\mathbb{P} \left( \mathcal{Z} \leq \frac{\ln(x)-\ln(X_0)-\mu}{\sigma} \right) \\
&amp;=\frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\frac{\ln(x)-\ln(X_0)-\mu}{\sigma}} e^{\frac{-t^2}{2}}\,dt \\ \rightarrow f_{X_1}(x) &amp;= \frac{1}{\sqrt{2\pi}} \times \left( \frac{\ln(x)-\ln(X_0)-\mu}{\sigma} \right)' \times e^{\frac{-\left( \frac{\ln(x)-\ln(X_0)-\mu}{\sigma} \right)^2}{2}} \\
&amp;=\frac{e^{-\frac{(\ln(x)-\ln(X_0)-\mu)^2}{2\sigma^2}}}{\sigma x \sqrt{2\pi}}
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: <span class="math inline">\(f_{X_1}(x)=\frac{e^{-\frac{(\ln(x)-\ln(X_0)-\mu)^2}{2\sigma^2}}}{\sigma x \sqrt{2\pi}}\)</span></p>
</blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Find a formula for the <span class="math inline">\(0.9\)</span> quantile of <span class="math inline">\(X_k\)</span> for each <span class="math inline">\(k \in \mathbb{N}\)</span>.</li>
</ol>
<blockquote>
<p>Let <span class="math inline">\(x_k\)</span> be the 0.9 quantile of <span class="math inline">\(X_k\)</span>
<span class="math display">\[\begin{align*}
\sum_{i=1}^{k} r_i &amp;\sim k \times \mathcal{N}(\mu,\sigma^2) \\
&amp;\sim \mathcal{N}(k\mu,k\sigma^2) \\
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p><span class="math display">\[\begin{align*}
\mathbb{P}(X_k \leq x_k) &amp;= \mathbb{P} \left( \frac{X_k}{X_0} \leq \frac{x_k}{X_0} \right) \\
&amp;= \mathbb{P} \left( e^{\sum_{i=1}^{k} r_i} \leq \frac{x_k}{X_0} \right) \\
&amp;=\mathbb{P} \left({\sum_{i=1}^{k} r_i} \leq \ln(x_k) -\ln(X_0) \right) \\
&amp;=\mathbb{P} \left( \mathcal{Z} \leq \frac{\ln(x_k) -\ln(X_0)-k\mu}{\sigma \sqrt{k}} \right) \\
&amp;=\Phi \left( \frac{\ln(x_k) -\ln(X_0)-k\mu}{\sigma \sqrt{k}} \right)
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p><span class="math display">\[\begin{align*}
&amp;\mathbb{P}(X_k \leq x_k) = 0.9 \\
&amp;\rightarrow \Phi \left( \frac{\ln(x_k) -\ln(X_0)-k\mu}{\sigma \sqrt{k}} \right) = 0.9 \\
&amp;\rightarrow \frac{\ln(x_k) -\ln(X_0)-k\mu}{\sigma \sqrt{k}}=\Phi^{-1}(0.9) \\
&amp;\rightarrow x_k=X_0 e^{\Phi^{-1}(0.9) \sigma \sqrt{k} +k\mu}
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Answer: The formula for the 0.9 quantile of <span class="math inline">\(X_k\)</span> for each <span class="math inline">\(k \in \mathbb{N}\)</span> is <span class="math inline">\(X_0 e^{\Phi^{-1}(0.9) \sigma \sqrt{k} +k\mu}\)</span>.</p>
</blockquote>
</div>
<div id="problem-6" class="section level2" number="15.2">
<h2>
<span class="header-section-number">15.2</span> Problem 6<a class="anchor" aria-label="anchor" href="#problem-6"><i class="fas fa-link"></i></a>
</h2>
<p>Given data of McDonald’s stock returns. Using R or Python:</p>
<div id="python-3" class="section level3 unnumbered">
<h3>Python<a class="anchor" aria-label="anchor" href="#python-3"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: lower-alpha">
<li>Plot histogram and display fitted normal.</li>
</ol>
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="homework-1.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb100-2"><a href="homework-1.html#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="homework-1.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data from my Google Spreadsheet</span></span>
<span id="cb100-4"><a href="homework-1.html#cb100-4" aria-hidden="true" tabindex="-1"></a>mcd_url <span class="op">=</span> <span class="st">'https://docs.google.com/spreadsheets/d/e/2PACX-1vTI1rEZM9rAQqxrz5ogOTzKJZXD99n6vmsRpZXFzILLoyBs-ViFx24WOC5jqf61uaG7M5XDv6h3kG4D/pub?gid=2115254660&amp;single=true&amp;output=csv'</span></span>
<span id="cb100-5"><a href="homework-1.html#cb100-5" aria-hidden="true" tabindex="-1"></a>mcd <span class="op">=</span> pd.read_csv(mcd_url)</span>
<span id="cb100-6"><a href="homework-1.html#cb100-6" aria-hidden="true" tabindex="-1"></a>mcd.head()</span></code></pre></div>
<pre><code>#&gt;        Date   Open   High    Low  Close    Volume  Adj Close
#&gt; 0  1/4/2010  62.63  63.07  62.31  62.78   5839300      53.99
#&gt; 1  1/5/2010  62.66  62.75  62.19  62.30   7099000      53.58
#&gt; 2  1/6/2010  62.20  62.41  61.06  61.45  10551300      52.85
#&gt; 3  1/7/2010  61.25  62.34  61.11  61.90   7517700      53.24
#&gt; 4  1/8/2010  62.27  62.41  61.60  61.84   6107300      53.19</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="homework-1.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb102-2"><a href="homework-1.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Log Returns</span></span>
<span id="cb102-3"><a href="homework-1.html#cb102-3" aria-hidden="true" tabindex="-1"></a>mcd_logret <span class="op">=</span> np.log(<span class="bu">list</span>(mcd[<span class="st">'Adj Close'</span>])[<span class="dv">1</span>:]) <span class="op">-</span> np.log(<span class="bu">list</span>(mcd[<span class="st">'Adj Close'</span>])[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb102-4"><a href="homework-1.html#cb102-4" aria-hidden="true" tabindex="-1"></a>mcd_logret[:<span class="dv">6</span>] <span class="co"># first 10 elements</span></span></code></pre></div>
<pre><code>#&gt; array([-0.00762298, -0.01371815,  0.00735228, -0.00093958,  0.00767866,
#&gt;         0.00539586])</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="homework-1.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats.distributions <span class="im">import</span> norm</span>
<span id="cb104-2"><a href="homework-1.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb104-3"><a href="homework-1.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram and fitted normal distribution</span></span>
<span id="cb104-4"><a href="homework-1.html#cb104-4" aria-hidden="true" tabindex="-1"></a>mu, var <span class="op">=</span> norm.fit(mcd_logret)</span>
<span id="cb104-5"><a href="homework-1.html#cb104-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="bu">min</span>(mcd_logret), <span class="bu">max</span>(mcd_logret), <span class="dv">100</span>)</span>
<span id="cb104-6"><a href="homework-1.html#cb104-6" aria-hidden="true" tabindex="-1"></a>fitted_mcd_logret <span class="op">=</span> norm.pdf(x, mu, var)</span>
<span id="cb104-7"><a href="homework-1.html#cb104-7" aria-hidden="true" tabindex="-1"></a>plt.hist(mcd_logret, density <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<pre><code>#&gt; (array([ 0.18620447,  0.46551117,  2.60686253,  9.4964278 , 37.24089335,
#&gt;        46.27180998, 10.6136546 ,  2.2344536 ,  0.09310223,  0.2793067 ]), array([-0.04555068, -0.03641728, -0.02728388, -0.01815047, -0.00901707,
#&gt;         0.00011633,  0.00924973,  0.01838313,  0.02751654,  0.03664994,
#&gt;         0.04578334]), &lt;BarContainer object of 10 artists&gt;)</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="homework-1.html#cb106-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x, fitted_mcd_logret, <span class="st">'r-'</span>)</span>
<span id="cb106-2"><a href="homework-1.html#cb106-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;"></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Use QQ plot and Jaque-Bera test to test for normality and interpret the result.</li>
</ol>
<div class="sourceCode" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="homework-1.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb107-2"><a href="homework-1.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pylab</span>
<span id="cb107-3"><a href="homework-1.html#cb107-3" aria-hidden="true" tabindex="-1"></a>sm.qqplot(mcd_logret, line <span class="op">=</span> <span class="st">'s'</span>)</span>
<span id="cb107-4"><a href="homework-1.html#cb107-4" aria-hidden="true" tabindex="-1"></a>pylab.show()</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-12-3.png" width="90%" style="display: block; margin: auto;"></div>
<p>There are presence of outliers, i.e. the log returns seems not normally distributed.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="homework-1.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> jarque_bera</span>
<span id="cb108-2"><a href="homework-1.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Carry out a Jarque-Bera tests</span></span>
<span id="cb108-3"><a href="homework-1.html#cb108-3" aria-hidden="true" tabindex="-1"></a>jarque_bera(mcd_logret)</span></code></pre></div>
<pre><code>#&gt; Jarque_beraResult(statistic=367.2407128291914, pvalue=0.0)</code></pre>
<p><span class="math inline">\(p−value&lt;0.05\)</span> so we can reject the null hypothesis <span class="math inline">\(H_0\)</span>: <span class="math inline">\(Sk=0\)</span> and <span class="math inline">\(Kur=3\)</span> meaning that the log return of the data do not follow the normal distribution.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Calculate skewness, kurtosis and give some comments related to risk management.</li>
</ol>
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="homework-1.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> skew, kurtosis</span>
<span id="cb110-2"><a href="homework-1.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Skewness and Kurtosis</span></span>
<span id="cb110-3"><a href="homework-1.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Skewness:'</span>, skew(mcd_logret))</span></code></pre></div>
<pre><code>#&gt; Skewness: -0.1604213839619458</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="homework-1.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Excess Kurtosis:'</span>, kurtosis(mcd_logret))</span></code></pre></div>
<pre><code>#&gt; Excess Kurtosis: 2.7187806721684025</code></pre>
<p>A negative skewness indicates a left-skewed distribution, i.e. investors can expect recurrent small gains and few huge losses from investing in McDonalds’ stock. Hence the stock is not potential for investors since it is expected that huge losses may overwhelm the frequent (but small) gains.</p>
<p>A positive excess kurtosis indicates a leptokurtic distribution, i.e. it has large outliers. Hence the McDonalds’ stock is not desirable for pessimistic investors since chance of experiencing big losses is high.</p>
</div>
<div id="r-3" class="section level3 unnumbered">
<h3>R<a class="anchor" aria-label="anchor" href="#r-3"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: lower-alpha">
<li>Plot histogram and display fitted normal.</li>
</ol>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>

<span class="co"># Import data from my Google Spreadsheet</span>
<span class="va">mcd_url</span><span class="op">=</span><span class="st">"https://docs.google.com/spreadsheets/d/e/2PACX-1vTI1rEZM9rAQqxrz5ogOTzKJZXD99n6vmsRpZXFzILLoyBs-ViFx24WOC5jqf61uaG7M5XDv6h3kG4D/pub?gid=2115254660&amp;single=true&amp;output=csv"</span>
<span class="va">mcd</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="va">mcd_url</span><span class="op">)</span>

<span class="co"># Calculate log return</span>
<span class="va">mcd_logret</span><span class="op">=</span> <span class="va">mcd</span><span class="op">$</span><span class="va">Adj.Close</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-diff.html">diff</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; [1] -0.0076229801 -0.0137181518  0.0073522812 -0.0009395848  0.0076786593
#&gt; [6]  0.0053958639</code></pre>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Histogram and fitted normal distribution</span>
<span class="va">h</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span>
<span class="va">xfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">yfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">xfit</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-diff.html">diff</a></span><span class="op">(</span><span class="va">h</span><span class="op">$</span><span class="va">mids</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/timeDate/man/base-length.html">length</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">xfit</span>, <span class="va">yfit</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;"></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Use QQ plot and Jaque-Bera test to test for normality and interpret the result. (c) Calculate skewness, kurtosis and give some comments related to risk management.</li>
</ol>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org">moments</a></span><span class="op">)</span>
<span class="co"># Make a Q-Q plot and add a red line</span>
<span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">mcd_logret</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-cross-refs_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>There are presence of outliers, i.e. the log returns seems not normally distributed.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Carry out a Jarque-Bera test</span>
<span class="fu"><a href="https://rdrr.io/pkg/moments/man/jarque.test.html">jarque.test</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; 
#&gt;  Jarque-Bera Normality Test
#&gt; 
#&gt; data:  mcd_logret
#&gt; JB = 367.24, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: greater</code></pre>
<p><span class="math inline">\(p−value&lt;0.05\)</span> so we can reject the null hypothesis <span class="math inline">\(H_0\)</span>: <span class="math inline">\(Sk=0\)</span> and <span class="math inline">\(Kur=3\)</span> meaning that the log return of the data do not follow the normal distribution.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Calculate skewness, kurtosis and give some comments related to risk management.</li>
</ol>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org">moments</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; [1] -0.1604214</code></pre>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">mcd_logret</span><span class="op">)</span><span class="op">-</span><span class="fl">3</span></code></pre></div>
<pre><code>#&gt; [1] 2.718781</code></pre>
<p>A negative skewness indicates a left-skewed distribution, i.e. investors can expect recurrent small gains and few huge losses from investing in McDonalds’ stock. Hence the stock is not potential for investors since it is expected that huge losses may overwhelm the frequent (but small) gains.</p>
<p>A positive excess kurtosis indicates a leptokurtic distribution, i.e. it has large outliers. Hence the McDonalds’ stock is not desirable for pessimistic investors since chance of experiencing big losses is high.</p>
</div>
</div>
<div id="problem-7" class="section level2" number="15.3">
<h2>
<span class="header-section-number">15.3</span> Problem 7<a class="anchor" aria-label="anchor" href="#problem-7"><i class="fas fa-link"></i></a>
</h2>
<p>Assume a random variable X has the distribution
<span class="math display">\[P(X =−4)= \frac{1}{3}, P(X =1)= \frac{1}{2}, P(X =5)= \frac{1}{6}\]</span></p>
<p>Check that <span class="math inline">\(X\)</span> has skewness <span class="math inline">\(0\)</span>, but is not distributed symmetrically.</p>
<blockquote>
<p><span class="math display">\[\begin{align*}
E[X^3] &amp;=\mathbb{P}(X=-4) \times (-4)^3+\mathbb{P}(X=1) \times (1)^3+\mathbb{P}(X=5) \times (5)^3 \\
&amp;=\frac{1}{3} \times (-64) + \frac{1}{2} \times (1)+\frac{1}{6} \times (125) \\
&amp;=0
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>Since <span class="math inline">\(\mu = E[X] = 0\)</span> and <span class="math inline">\(\sigma^2 = Var(X) = 10\)</span>, the skewness of <span class="math inline">\(X\)</span> is given by
<span class="math display">\[ \tilde \mu_3=\frac{\mathbb{E}(X^3)-3\mu\sigma^2-\mu^3}{\sigma^3}=\frac{0-0-0}{\sqrt{1000}}=0 \]</span></p>
</blockquote>
<blockquote>
<p>Suppose X has a symmetric distribution, there exists <span class="math inline">\(x_0 \in \mathbb{R}\)</span> such that
<span class="math display">\[ \mathbb{P}(X=x_0-\delta)=\mathbb{P}(X=x_0+\delta), \forall \delta &gt;0 \]</span></p>
</blockquote>
<blockquote>
<p>Letting <span class="math inline">\(\delta=x_0-1\)</span> implies
<span class="math display">\[\mathbb{P}(X=1)=\mathbb{P}(X=2x_0-1)=\frac{1}{2}, \forall \delta &gt;0\]</span></p>
</blockquote>
<blockquote>
<p>thus <span class="math inline">\(2x_0-1=1\)</span>, i.e. <span class="math inline">\(x_0=1\)</span>. Letting <span class="math inline">\(\delta=4\)</span> gives
<span class="math display">\[ 0=\mathbb{P}(X=-3)=\mathbb{P}(X=5)=\frac{1}{6} (!) \]</span></p>
</blockquote>
</div>
<div id="problem-8" class="section level2" number="15.4">
<h2>
<span class="header-section-number">15.4</span> Problem 8<a class="anchor" aria-label="anchor" href="#problem-8"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: lower-alpha">
<li>Show that if X, Y are random variables and cov(X, Y ) = 0, then X, Y may not be independent.</li>
</ol>
<blockquote>
<p>Let <span class="math inline">\(X\)</span> be the normal distribution and <span class="math inline">\(Y\)</span> be <span class="math inline">\(X^2\)</span> then
<span class="math display">\[ Cov(X,Y)=\mathbb{E}(XY)-E(X)E(Y)=0 \]</span></p>
</blockquote>
<blockquote>
<p>However,
<span class="math display">\[ 0.25=\mathbb{E}(Y|X=0.5) \neq E(Y)=Var(X)=1 \]</span></p>
</blockquote>
<blockquote>
<p>Hence, X and Y are not inidependent.</p>
</blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Prove that correlation is invariant under linear transformations.</li>
</ol>
<blockquote>
<p>Let a, b, c, d be constants with ac &gt; 0, then for any random variables X, Y, we have
<span class="math display">\[\begin{align*}
Corr(aX+b,cY+d)&amp;=\frac{Cov(aX+b,cY++d)}{\sqrt{Var(aX+b)Var(cY+d)}} \\
&amp;=\frac{ac \times Cov(X,Y)}{\sqrt{a^2c^2Var(X)Var(Y)}} \\
&amp;=\frac{Cov(X,Y)}{\sqrt{Var(X)Var(Y)}} \\
&amp;=Corr(X,Y)
\end{align*}\]</span></p>
</blockquote>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="in-class-exercise-1.html"><span class="header-section-number">14</span> In-class exercise</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#homework-1"><span class="header-section-number">15</span> Homework</a></li>
<li><a class="nav-link" href="#problem-5"><span class="header-section-number">15.1</span> Problem 5</a></li>
<li>
<a class="nav-link" href="#problem-6"><span class="header-section-number">15.2</span> Problem 6</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#python-3">Python</a></li>
<li><a class="nav-link" href="#r-3">R</a></li>
</ul>
</li>
<li><a class="nav-link" href="#problem-7"><span class="header-section-number">15.3</span> Problem 7</a></li>
<li><a class="nav-link" href="#problem-8"><span class="header-section-number">15.4</span> Problem 8</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/cliex159/fin-risk-mana/blob/master/02-cross-refs.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/cliex159/fin-risk-mana/edit/master/02-cross-refs.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>FRM2</strong>" was written by Tran Thanh Dat. It was last built on 2022-03-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
